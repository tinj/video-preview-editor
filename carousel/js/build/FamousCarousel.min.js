(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var RenderNode=require("./RenderNode");var EventHandler=require("./EventHandler");var ElementAllocator=require("./ElementAllocator");var Transform=require("./Transform");var Transitionable=require("famous/transitions/Transitionable");var _originZeroZero=[0,0];function _getElementSize(element){return[element.clientWidth,element.clientHeight]}function Context(container){this.container=container;this._allocator=new ElementAllocator(container);this._node=new RenderNode;this._eventOutput=new EventHandler;this._size=_getElementSize(this.container);this._perspectiveState=new Transitionable(0);this._perspective=undefined;this._nodeContext={allocator:this._allocator,transform:Transform.identity,opacity:1,origin:_originZeroZero,align:null,size:this._size};this._eventOutput.on("resize",function(){this.setSize(_getElementSize(this.container))}.bind(this))}Context.prototype.getAllocator=function getAllocator(){return this._allocator};Context.prototype.add=function add(obj){return this._node.add(obj)};Context.prototype.migrate=function migrate(container){if(container===this.container)return;this.container=container;this._allocator.migrate(container)};Context.prototype.getSize=function getSize(){return this._size};Context.prototype.setSize=function setSize(size){if(!size)size=_getElementSize(this.container);this._size[0]=size[0];this._size[1]=size[1]};Context.prototype.update=function update(contextParameters){if(contextParameters){if(contextParameters.transform)this._nodeContext.transform=contextParameters.transform;if(contextParameters.opacity)this._nodeContext.opacity=contextParameters.opacity;if(contextParameters.origin)this._nodeContext.origin=contextParameters.origin;if(contextParameters.align)this._nodeContext.align=contextParameters.align;if(contextParameters.size)this._nodeContext.size=contextParameters.size}var perspective=this._perspectiveState.get();if(perspective!==this._perspective){this.container.style.perspective=perspective?perspective.toFixed()+"px":"";this.container.style.webkitPerspective=perspective?perspective.toFixed():"";this._perspective=perspective}this._node.commit(this._nodeContext)};Context.prototype.getPerspective=function getPerspective(){return this._perspectiveState.get()};Context.prototype.setPerspective=function setPerspective(perspective,transition,callback){return this._perspectiveState.set(perspective,transition,callback)};Context.prototype.emit=function emit(type,event){return this._eventOutput.emit(type,event)};Context.prototype.on=function on(type,handler){return this._eventOutput.on(type,handler)};Context.prototype.removeListener=function removeListener(type,handler){return this._eventOutput.removeListener(type,handler)};Context.prototype.pipe=function pipe(target){return this._eventOutput.pipe(target)};Context.prototype.unpipe=function unpipe(target){return this._eventOutput.unpipe(target)};module.exports=Context},{"./ElementAllocator":2,"./EventHandler":7,"./RenderNode":10,"./Transform":13,"famous/transitions/Transitionable":37}],2:[function(require,module,exports){function ElementAllocator(container){if(!container)container=document.createDocumentFragment();this.container=container;this.detachedNodes={};this.nodeCount=0}ElementAllocator.prototype.migrate=function migrate(container){var oldContainer=this.container;if(container===oldContainer)return;if(oldContainer instanceof DocumentFragment){container.appendChild(oldContainer)}else{while(oldContainer.hasChildNodes()){container.appendChild(oldContainer.removeChild(oldContainer.firstChild))}}this.container=container};ElementAllocator.prototype.allocate=function allocate(type){type=type.toLowerCase();if(!(type in this.detachedNodes))this.detachedNodes[type]=[];var nodeStore=this.detachedNodes[type];var result;if(nodeStore.length>0){result=nodeStore.pop()}else{result=document.createElement(type);this.container.appendChild(result)}this.nodeCount++;return result};ElementAllocator.prototype.deallocate=function deallocate(element){var nodeType=element.nodeName.toLowerCase();var nodeStore=this.detachedNodes[nodeType];nodeStore.push(element);this.nodeCount--};ElementAllocator.prototype.getNodeCount=function getNodeCount(){return this.nodeCount};module.exports=ElementAllocator},{}],3:[function(require,module,exports){var Entity=require("./Entity");var EventHandler=require("./EventHandler");var Transform=require("./Transform");var usePrefix=document.body.style.webkitTransform!==undefined;var devicePixelRatio=window.devicePixelRatio||1;function ElementOutput(element){this._matrix=null;this._opacity=1;this._origin=null;this._size=null;this._eventOutput=new EventHandler;this._eventOutput.bindThis(this);this.eventForwarder=function eventForwarder(event){this._eventOutput.emit(event.type,event)}.bind(this);this.id=Entity.register(this);this._element=null;this._sizeDirty=false;this._originDirty=false;this._transformDirty=false;this._invisible=false;if(element)this.attach(element)}ElementOutput.prototype.on=function on(type,fn){if(this._element)this._element.addEventListener(type,this.eventForwarder);this._eventOutput.on(type,fn)};ElementOutput.prototype.removeListener=function removeListener(type,fn){this._eventOutput.removeListener(type,fn)};ElementOutput.prototype.emit=function emit(type,event){if(event&&!event.origin)event.origin=this;var handled=this._eventOutput.emit(type,event);if(handled&&event&&event.stopPropagation)event.stopPropagation();return handled};ElementOutput.prototype.pipe=function pipe(target){return this._eventOutput.pipe(target)};ElementOutput.prototype.unpipe=function unpipe(target){return this._eventOutput.unpipe(target)};ElementOutput.prototype.render=function render(){return this.id};function _addEventListeners(target){for(var i in this._eventOutput.listeners){target.addEventListener(i,this.eventForwarder)}}function _removeEventListeners(target){for(var i in this._eventOutput.listeners){target.removeEventListener(i,this.eventForwarder)}}function _formatCSSTransform(m){m[12]=Math.round(m[12]*devicePixelRatio)/devicePixelRatio;m[13]=Math.round(m[13]*devicePixelRatio)/devicePixelRatio;var result="matrix3d(";for(var i=0;i<15;i++){result+=m[i]<1e-6&&m[i]>-1e-6?"0,":m[i]+","}result+=m[15]+")";return result}var _setMatrix;if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1){_setMatrix=function(element,matrix){element.style.zIndex=matrix[14]*1e6|0;element.style.transform=_formatCSSTransform(matrix)}}else if(usePrefix){_setMatrix=function(element,matrix){element.style.webkitTransform=_formatCSSTransform(matrix)}}else{_setMatrix=function(element,matrix){element.style.transform=_formatCSSTransform(matrix)}}function _formatCSSOrigin(origin){return 100*origin[0]+"% "+100*origin[1]+"%"}var _setOrigin=usePrefix?function(element,origin){element.style.webkitTransformOrigin=_formatCSSOrigin(origin)}:function(element,origin){element.style.transformOrigin=_formatCSSOrigin(origin)};var _setInvisible=usePrefix?function(element){element.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)";element.style.opacity=0}:function(element){element.style.transform="scale3d(0.0001,0.0001,0.0001)";element.style.opacity=0};function _xyNotEquals(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}ElementOutput.prototype.commit=function commit(context){var target=this._element;if(!target)return;var matrix=context.transform;var opacity=context.opacity;var origin=context.origin;var size=context.size;if(!matrix&&this._matrix){this._matrix=null;this._opacity=0;_setInvisible(target);return}if(_xyNotEquals(this._origin,origin))this._originDirty=true;if(Transform.notEquals(this._matrix,matrix))this._transformDirty=true;if(this._invisible){this._invisible=false;this._element.style.display=""}if(this._opacity!==opacity){this._opacity=opacity;target.style.opacity=opacity>=1?"0.999999":opacity}if(this._transformDirty||this._originDirty||this._sizeDirty){if(this._sizeDirty){if(!this._size)this._size=[0,0];this._size[0]=size[0];this._size[1]=size[1];this._sizeDirty=false}if(this._originDirty){if(origin){if(!this._origin)this._origin=[0,0];this._origin[0]=origin[0];this._origin[1]=origin[1]}else this._origin=null;_setOrigin(target,this._origin);this._originDirty=false}if(!matrix)matrix=Transform.identity;this._matrix=matrix;var aaMatrix=this._size?Transform.thenMove(matrix,[-this._size[0]*origin[0],-this._size[1]*origin[1],0]):matrix;_setMatrix(target,aaMatrix);this._transformDirty=false}};ElementOutput.prototype.cleanup=function cleanup(){if(this._element){this._invisible=true;this._element.style.display="none"}};ElementOutput.prototype.attach=function attach(target){this._element=target;_addEventListeners.call(this,target)};ElementOutput.prototype.detach=function detach(){var target=this._element;if(target){_removeEventListeners.call(this,target);if(this._invisible){this._invisible=false;this._element.style.display=""}}this._element=null;return target};module.exports=ElementOutput},{"./Entity":5,"./EventHandler":7,"./Transform":13}],4:[function(require,module,exports){var Context=require("./Context");var EventHandler=require("./EventHandler");var OptionsManager=require("./OptionsManager");var Engine={};var contexts=[];var nextTickQueue=[];var deferQueue=[];var lastTime=Date.now();var frameTime;var frameTimeLimit;var loopEnabled=true;var eventForwarders={};var eventHandler=new EventHandler;var options={containerType:"div",containerClass:"famous-container",fpsCap:undefined,runLoop:true,appMode:true};var optionsManager=new OptionsManager(options);var MAX_DEFER_FRAME_TIME=10;Engine.step=function step(){var currentTime=Date.now();if(frameTimeLimit&&currentTime-lastTime<frameTimeLimit)return;var i=0;frameTime=currentTime-lastTime;lastTime=currentTime;eventHandler.emit("prerender");for(i=0;i<nextTickQueue.length;i++)nextTickQueue[i].call(this);nextTickQueue.splice(0);while(deferQueue.length&&Date.now()-currentTime<MAX_DEFER_FRAME_TIME){deferQueue.shift().call(this)}for(i=0;i<contexts.length;i++)contexts[i].update();eventHandler.emit("postrender")};function loop(){if(options.runLoop){Engine.step();window.requestAnimationFrame(loop)}else loopEnabled=false}window.requestAnimationFrame(loop);function handleResize(event){for(var i=0;i<contexts.length;i++){contexts[i].emit("resize")}eventHandler.emit("resize")}window.addEventListener("resize",handleResize,false);handleResize();function initialize(){window.addEventListener("touchmove",function(event){event.preventDefault()},true);document.body.classList.add("famous-root");document.documentElement.classList.add("famous-root")}var initialized=false;Engine.pipe=function pipe(target){if(target.subscribe instanceof Function)return target.subscribe(Engine);else return eventHandler.pipe(target)};Engine.unpipe=function unpipe(target){if(target.unsubscribe instanceof Function)return target.unsubscribe(Engine);else return eventHandler.unpipe(target)};Engine.on=function on(type,handler){if(!(type in eventForwarders)){eventForwarders[type]=eventHandler.emit.bind(eventHandler,type);if(document.body){document.body.addEventListener(type,eventForwarders[type])}else{Engine.nextTick(function(type,forwarder){document.body.addEventListener(type,forwarder)}.bind(this,type,eventForwarders[type]))}}return eventHandler.on(type,handler)};Engine.emit=function emit(type,event){return eventHandler.emit(type,event)};Engine.removeListener=function removeListener(type,handler){return eventHandler.removeListener(type,handler)};Engine.getFPS=function getFPS(){return 1e3/frameTime};Engine.setFPSCap=function setFPSCap(fps){frameTimeLimit=Math.floor(1e3/fps)};Engine.getOptions=function getOptions(){return optionsManager.getOptions.apply(optionsManager,arguments)};Engine.setOptions=function setOptions(options){return optionsManager.setOptions.apply(optionsManager,arguments)};Engine.createContext=function createContext(el){if(!initialized&&options.appMode)initialize();var needMountContainer=false;if(!el){el=document.createElement(options.containerType);el.classList.add(options.containerClass);needMountContainer=true}var context=new Context(el);Engine.registerContext(context);if(needMountContainer){Engine.nextTick(function(context,el){document.body.appendChild(el);context.emit("resize")}.bind(this,context,el))}return context};Engine.registerContext=function registerContext(context){contexts.push(context);return context};Engine.getContexts=function getContexts(){return contexts};Engine.deregisterContext=function deregisterContext(context){var i=contexts.indexOf(context);if(i>=0)contexts.splice(i,1)};Engine.nextTick=function nextTick(fn){nextTickQueue.push(fn)};Engine.defer=function defer(fn){deferQueue.push(fn)};optionsManager.on("change",function(data){if(data.id==="fpsCap")Engine.setFPSCap(data.value);else if(data.id==="runLoop"){if(!loopEnabled&&data.value){loopEnabled=true;window.requestAnimationFrame(loop)}}});module.exports=Engine},{"./Context":1,"./EventHandler":7,"./OptionsManager":9}],5:[function(require,module,exports){var entities=[];function get(id){return entities[id]}function set(id,entity){entities[id]=entity}function register(entity){var id=entities.length;set(id,entity);return id}function unregister(id){set(id,null)}module.exports={register:register,unregister:unregister,get:get,set:set}},{}],6:[function(require,module,exports){function EventEmitter(){this.listeners={};this._owner=this}EventEmitter.prototype.emit=function emit(type,event){var handlers=this.listeners[type];if(handlers){for(var i=0;i<handlers.length;i++){handlers[i].call(this._owner,event)}}return this};EventEmitter.prototype.on=function on(type,handler){if(!(type in this.listeners))this.listeners[type]=[];var index=this.listeners[type].indexOf(handler);if(index<0)this.listeners[type].push(handler);return this};EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prototype.removeListener=function removeListener(type,handler){var listener=this.listeners[type];if(listener!==undefined){var index=listener.indexOf(handler);if(index>=0)listener.splice(index,1)}return this};EventEmitter.prototype.bindThis=function bindThis(owner){this._owner=owner};module.exports=EventEmitter},{}],7:[function(require,module,exports){var EventEmitter=require("./EventEmitter");function EventHandler(){EventEmitter.apply(this,arguments);this.downstream=[];this.downstreamFn=[];this.upstream=[];this.upstreamListeners={}}EventHandler.prototype=Object.create(EventEmitter.prototype);EventHandler.prototype.constructor=EventHandler;EventHandler.setInputHandler=function setInputHandler(object,handler){object.trigger=handler.trigger.bind(handler);if(handler.subscribe&&handler.unsubscribe){object.subscribe=handler.subscribe.bind(handler);object.unsubscribe=handler.unsubscribe.bind(handler)}};EventHandler.setOutputHandler=function setOutputHandler(object,handler){if(handler instanceof EventHandler)handler.bindThis(object);object.pipe=handler.pipe.bind(handler);object.unpipe=handler.unpipe.bind(handler);object.on=handler.on.bind(handler);object.addListener=object.on;object.removeListener=handler.removeListener.bind(handler)};EventHandler.prototype.emit=function emit(type,event){EventEmitter.prototype.emit.apply(this,arguments);var i=0;for(i=0;i<this.downstream.length;i++){if(this.downstream[i].trigger)this.downstream[i].trigger(type,event)}for(i=0;i<this.downstreamFn.length;i++){this.downstreamFn[i](type,event)}return this};EventHandler.prototype.trigger=EventHandler.prototype.emit;EventHandler.prototype.pipe=function pipe(target){if(target.subscribe instanceof Function)return target.subscribe(this);var downstreamCtx=target instanceof Function?this.downstreamFn:this.downstream;var index=downstreamCtx.indexOf(target);if(index<0)downstreamCtx.push(target);if(target instanceof Function)target("pipe",null);else if(target.trigger)target.trigger("pipe",null);return target};EventHandler.prototype.unpipe=function unpipe(target){if(target.unsubscribe instanceof Function)return target.unsubscribe(this);var downstreamCtx=target instanceof Function?this.downstreamFn:this.downstream;var index=downstreamCtx.indexOf(target);if(index>=0){downstreamCtx.splice(index,1);if(target instanceof Function)target("unpipe",null);else if(target.trigger)target.trigger("unpipe",null);return target}else return false};EventHandler.prototype.on=function on(type,handler){EventEmitter.prototype.on.apply(this,arguments);if(!(type in this.upstreamListeners)){var upstreamListener=this.trigger.bind(this,type);this.upstreamListeners[type]=upstreamListener;for(var i=0;i<this.upstream.length;i++){this.upstream[i].on(type,upstreamListener)}}return this};EventHandler.prototype.addListener=EventHandler.prototype.on;EventHandler.prototype.subscribe=function subscribe(source){var index=this.upstream.indexOf(source);if(index<0){this.upstream.push(source);for(var type in this.upstreamListeners){source.on(type,this.upstreamListeners[type])}}return this};EventHandler.prototype.unsubscribe=function unsubscribe(source){var index=this.upstream.indexOf(source);if(index>=0){this.upstream.splice(index,1);for(var type in this.upstreamListeners){source.removeListener(type,this.upstreamListeners[type])}}return this};module.exports=EventHandler},{"./EventEmitter":6}],8:[function(require,module,exports){var Transform=require("./Transform");var Transitionable=require("famous/transitions/Transitionable");var TransitionableTransform=require("famous/transitions/TransitionableTransform");function Modifier(options){this._transformGetter=null;this._opacityGetter=null;this._originGetter=null;this._alignGetter=null;this._sizeGetter=null;this._legacyStates={};this._output={transform:Transform.identity,opacity:1,origin:null,align:null,size:null,target:null};if(options){if(options.transform)this.transformFrom(options.transform);if(options.opacity!==undefined)this.opacityFrom(options.opacity);if(options.origin)this.originFrom(options.origin);if(options.align)this.alignFrom(options.align);if(options.size)this.sizeFrom(options.size)}}Modifier.prototype.transformFrom=function transformFrom(transform){if(transform instanceof Function)this._transformGetter=transform;else if(transform instanceof Object&&transform.get)this._transformGetter=transform.get.bind(transform);else{this._transformGetter=null;this._output.transform=transform}return this};Modifier.prototype.opacityFrom=function opacityFrom(opacity){if(opacity instanceof Function)this._opacityGetter=opacity;else if(opacity instanceof Object&&opacity.get)this._opacityGetter=opacity.get.bind(opacity);else{this._opacityGetter=null;this._output.opacity=opacity}return this};Modifier.prototype.originFrom=function originFrom(origin){if(origin instanceof Function)this._originGetter=origin;else if(origin instanceof Object&&origin.get)this._originGetter=origin.get.bind(origin);else{this._originGetter=null;this._output.origin=origin}return this};Modifier.prototype.alignFrom=function alignFrom(align){if(align instanceof Function)this._alignGetter=align;else if(align instanceof Object&&align.get)this._alignGetter=align.get.bind(align);else{this._alignGetter=null;this._output.align=align}return this};Modifier.prototype.sizeFrom=function sizeFrom(size){if(size instanceof Function)this._sizeGetter=size;else if(size instanceof Object&&size.get)this._sizeGetter=size.get.bind(size);else{this._sizeGetter=null;this._output.size=size}return this};Modifier.prototype.setTransform=function setTransform(transform,transition,callback){if(transition||this._legacyStates.transform){if(!this._legacyStates.transform){this._legacyStates.transform=new TransitionableTransform(this._output.transform)}if(!this._transformGetter)this.transformFrom(this._legacyStates.transform);this._legacyStates.transform.set(transform,transition,callback);return this}else return this.transformFrom(transform)};Modifier.prototype.setOpacity=function setOpacity(opacity,transition,callback){if(transition||this._legacyStates.opacity){if(!this._legacyStates.opacity){this._legacyStates.opacity=new Transitionable(this._output.opacity)}if(!this._opacityGetter)this.opacityFrom(this._legacyStates.opacity);return this._legacyStates.opacity.set(opacity,transition,callback)}else return this.opacityFrom(opacity)};Modifier.prototype.setOrigin=function setOrigin(origin,transition,callback){if(transition||this._legacyStates.origin){if(!this._legacyStates.origin){this._legacyStates.origin=new Transitionable(this._output.origin||[0,0])}if(!this._originGetter)this.originFrom(this._legacyStates.origin);this._legacyStates.origin.set(origin,transition,callback);return this}else return this.originFrom(origin)};Modifier.prototype.setAlign=function setAlign(align,transition,callback){if(transition||this._legacyStates.align){if(!this._legacyStates.align){this._legacyStates.align=new Transitionable(this._output.align||[0,0])}if(!this._alignGetter)this.alignFrom(this._legacyStates.align);this._legacyStates.align.set(align,transition,callback);return this}else return this.alignFrom(align)};Modifier.prototype.setSize=function setSize(size,transition,callback){if(size&&(transition||this._legacyStates.size)){if(!this._legacyStates.size){this._legacyStates.size=new Transitionable(this._output.size||[0,0])}if(!this._sizeGetter)this.sizeFrom(this._legacyStates.size);this._legacyStates.size.set(size,transition,callback);return this}else return this.sizeFrom(size)};Modifier.prototype.halt=function halt(){if(this._legacyStates.transform)this._legacyStates.transform.halt();if(this._legacyStates.opacity)this._legacyStates.opacity.halt();if(this._legacyStates.origin)this._legacyStates.origin.halt();if(this._legacyStates.align)this._legacyStates.align.halt();if(this._legacyStates.size)this._legacyStates.size.halt();this._transformGetter=null;this._opacityGetter=null;this._originGetter=null;this._alignGetter=null;this._sizeGetter=null};Modifier.prototype.getTransform=function getTransform(){return this._transformGetter()};Modifier.prototype.getFinalTransform=function getFinalTransform(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform};Modifier.prototype.getOpacity=function getOpacity(){return this._opacityGetter()};Modifier.prototype.getOrigin=function getOrigin(){return this._originGetter()};Modifier.prototype.getAlign=function getAlign(){return this._alignGetter()};Modifier.prototype.getSize=function getSize(){return this._sizeGetter?this._sizeGetter():this._output.size};function _update(){if(this._transformGetter)this._output.transform=this._transformGetter();if(this._opacityGetter)this._output.opacity=this._opacityGetter();if(this._originGetter)this._output.origin=this._originGetter();if(this._alignGetter)this._output.align=this._alignGetter();if(this._sizeGetter)this._output.size=this._sizeGetter()}Modifier.prototype.modify=function modify(target){_update.call(this);this._output.target=target;return this._output};module.exports=Modifier},{"./Transform":13,"famous/transitions/Transitionable":37,"famous/transitions/TransitionableTransform":38}],9:[function(require,module,exports){var EventHandler=require("./EventHandler");function OptionsManager(value){this._value=value;this.eventOutput=null}OptionsManager.patch=function patchObject(source,data){var manager=new OptionsManager(source);for(var i=1;i<arguments.length;i++)manager.patch(arguments[i]);return source};function _createEventOutput(){this.eventOutput=new EventHandler;this.eventOutput.bindThis(this);EventHandler.setOutputHandler(this,this.eventOutput)}OptionsManager.prototype.patch=function patch(){var myState=this._value;for(var i=0;i<arguments.length;i++){var data=arguments[i];for(var k in data){if(k in myState&&(data[k]&&data[k].constructor===Object)&&(myState[k]&&myState[k].constructor===Object)){if(!myState.hasOwnProperty(k))myState[k]=Object.create(myState[k]);this.key(k).patch(data[k]);if(this.eventOutput)this.eventOutput.emit("change",{id:k,value:this.key(k).value()})}else this.set(k,data[k])}}return this};OptionsManager.prototype.setOptions=OptionsManager.prototype.patch;OptionsManager.prototype.key=function key(identifier){var result=new OptionsManager(this._value[identifier]);if(!(result._value instanceof Object)||result._value instanceof Array)result._value={};return result};OptionsManager.prototype.get=function get(key){return this._value[key]};OptionsManager.prototype.getOptions=OptionsManager.prototype.get;OptionsManager.prototype.set=function set(key,value){var originalValue=this.get(key);this._value[key]=value;if(this.eventOutput&&value!==originalValue)this.eventOutput.emit("change",{id:key,value:value});return this};OptionsManager.prototype.value=function value(){return this._value};OptionsManager.prototype.on=function on(){_createEventOutput.call(this);return this.on.apply(this,arguments)};OptionsManager.prototype.removeListener=function removeListener(){_createEventOutput.call(this);return this.removeListener.apply(this,arguments)};OptionsManager.prototype.pipe=function pipe(){_createEventOutput.call(this);return this.pipe.apply(this,arguments)};OptionsManager.prototype.unpipe=function unpipe(){_createEventOutput.call(this);return this.unpipe.apply(this,arguments)};module.exports=OptionsManager},{"./EventHandler":7}],10:[function(require,module,exports){var Entity=require("./Entity");var SpecParser=require("./SpecParser");function RenderNode(object){this._object=null;this._child=null;this._hasMultipleChildren=false;this._isRenderable=false;this._isModifier=false;this._resultCache={};this._prevResults={};this._childResult=null;if(object)this.set(object)}RenderNode.prototype.add=function add(child){var childNode=child instanceof RenderNode?child:new RenderNode(child);if(this._child instanceof Array)this._child.push(childNode);else if(this._child){this._child=[this._child,childNode];this._hasMultipleChildren=true;this._childResult=[]}else this._child=childNode;return childNode};RenderNode.prototype.get=function get(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)};RenderNode.prototype.set=function set(child){this._childResult=null;this._hasMultipleChildren=false;this._isRenderable=child.render?true:false;this._isModifier=child.modify?true:false;this._object=child;this._child=null;if(child instanceof RenderNode)return child;else return this};RenderNode.prototype.getSize=function getSize(){var result=null;var target=this.get();if(target&&target.getSize)result=target.getSize();if(!result&&this._child&&this._child.getSize)result=this._child.getSize();return result};function _applyCommit(spec,context,cacheStorage){var result=SpecParser.parse(spec,context);var keys=Object.keys(result);for(var i=0;i<keys.length;i++){var id=keys[i];var childNode=Entity.get(id);var commitParams=result[id];commitParams.allocator=context.allocator;var commitResult=childNode.commit(commitParams);if(commitResult)_applyCommit(commitResult,context,cacheStorage);else cacheStorage[id]=commitParams}}RenderNode.prototype.commit=function commit(context){var prevKeys=Object.keys(this._prevResults);for(var i=0;i<prevKeys.length;i++){var id=prevKeys[i];if(this._resultCache[id]===undefined){var object=Entity.get(id);if(object.cleanup)object.cleanup(context.allocator)}}this._prevResults=this._resultCache;this._resultCache={};_applyCommit(this.render(),context,this._resultCache)};RenderNode.prototype.render=function render(){if(this._isRenderable)return this._object.render();var result=null;if(this._hasMultipleChildren){result=this._childResult;var children=this._child;for(var i=0;i<children.length;i++){result[i]=children[i].render()}}else if(this._child)result=this._child.render();return this._isModifier?this._object.modify(result):result};module.exports=RenderNode},{"./Entity":5,"./SpecParser":11}],11:[function(require,module,exports){var Transform=require("./Transform");function SpecParser(){this.result={}}SpecParser._instance=new SpecParser;SpecParser.parse=function parse(spec,context){return SpecParser._instance.parse(spec,context)};SpecParser.prototype.parse=function parse(spec,context){this.reset();this._parseSpec(spec,context,Transform.identity);return this.result};SpecParser.prototype.reset=function reset(){this.result={}};function _vecInContext(v,m){return[v[0]*m[0]+v[1]*m[4]+v[2]*m[8],v[0]*m[1]+v[1]*m[5]+v[2]*m[9],v[0]*m[2]+v[1]*m[6]+v[2]*m[10]]}var _originZeroZero=[0,0];SpecParser.prototype._parseSpec=function _parseSpec(spec,parentContext,sizeContext){var id;var target;var transform;var opacity;var origin;var align;var size;if(typeof spec==="number"){id=spec;transform=parentContext.transform;align=parentContext.align||parentContext.origin;if(parentContext.size&&align&&(align[0]||align[1])){var alignAdjust=[align[0]*parentContext.size[0],align[1]*parentContext.size[1],0];transform=Transform.thenMove(transform,_vecInContext(alignAdjust,sizeContext))}this.result[id]={transform:transform,opacity:parentContext.opacity,origin:parentContext.origin||_originZeroZero,align:parentContext.align||parentContext.origin||_originZeroZero,size:parentContext.size}}else if(!spec){return}else if(spec instanceof Array){for(var i=0;i<spec.length;i++){this._parseSpec(spec[i],parentContext,sizeContext)}}else{target=spec.target;transform=parentContext.transform;opacity=parentContext.opacity;origin=parentContext.origin;align=parentContext.align;size=parentContext.size;var nextSizeContext=sizeContext;if(spec.opacity!==undefined)opacity=parentContext.opacity*spec.opacity;if(spec.transform)transform=Transform.multiply(parentContext.transform,spec.transform);if(spec.origin){origin=spec.origin;nextSizeContext=parentContext.transform}if(spec.align)align=spec.align;if(spec.size){var parentSize=parentContext.size;size=[spec.size[0]!==undefined?spec.size[0]:parentSize[0],spec.size[1]!==undefined?spec.size[1]:parentSize[1]];if(parentSize){if(!align)align=origin;if(align&&(align[0]||align[1]))transform=Transform.thenMove(transform,_vecInContext([align[0]*parentSize[0],align[1]*parentSize[1],0],sizeContext));if(origin&&(origin[0]||origin[1]))transform=Transform.moveThen([-origin[0]*size[0],-origin[1]*size[1],0],transform)}nextSizeContext=parentContext.transform;origin=null;align=null}this._parseSpec(target,{transform:transform,opacity:opacity,origin:origin,align:align,size:size},nextSizeContext)}};module.exports=SpecParser},{"./Transform":13}],12:[function(require,module,exports){var ElementOutput=require("./ElementOutput");function Surface(options){ElementOutput.call(this);this.options={};this.properties={};this.content="";this.classList=[];this.size=null;this._classesDirty=true;this._stylesDirty=true;this._sizeDirty=true;this._contentDirty=true;this._dirtyClasses=[];if(options)this.setOptions(options);this._currentTarget=null}Surface.prototype=Object.create(ElementOutput.prototype);Surface.prototype.constructor=Surface;Surface.prototype.elementType="div";Surface.prototype.elementClass="famous-surface";Surface.prototype.setProperties=function setProperties(properties){for(var n in properties){this.properties[n]=properties[n]}this._stylesDirty=true;return this};Surface.prototype.getProperties=function getProperties(){return this.properties};Surface.prototype.addClass=function addClass(className){if(this.classList.indexOf(className)<0){this.classList.push(className);this._classesDirty=true}return this};Surface.prototype.removeClass=function removeClass(className){var i=this.classList.indexOf(className);if(i>=0){this._dirtyClasses.push(this.classList.splice(i,1)[0]);this._classesDirty=true}return this};Surface.prototype.toggleClass=function toggleClass(className){var i=this.classList.indexOf(className);if(i>=0){this.removeClass(className)
}else{this.addClass(className)}return this};Surface.prototype.setClasses=function setClasses(classList){var i=0;var removal=[];for(i=0;i<this.classList.length;i++){if(classList.indexOf(this.classList[i])<0)removal.push(this.classList[i])}for(i=0;i<removal.length;i++)this.removeClass(removal[i]);for(i=0;i<classList.length;i++)this.addClass(classList[i]);return this};Surface.prototype.getClassList=function getClassList(){return this.classList};Surface.prototype.setContent=function setContent(content){if(this.content!==content){this.content=content;this._contentDirty=true}return this};Surface.prototype.getContent=function getContent(){return this.content};Surface.prototype.setOptions=function setOptions(options){if(options.size)this.setSize(options.size);if(options.classes)this.setClasses(options.classes);if(options.properties)this.setProperties(options.properties);if(options.content)this.setContent(options.content);return this};function _cleanupClasses(target){for(var i=0;i<this._dirtyClasses.length;i++)target.classList.remove(this._dirtyClasses[i]);this._dirtyClasses=[]}function _applyStyles(target){for(var n in this.properties){target.style[n]=this.properties[n]}}function _cleanupStyles(target){for(var n in this.properties){target.style[n]=""}}function _xyNotEquals(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}Surface.prototype.setup=function setup(allocator){var target=allocator.allocate(this.elementType);if(this.elementClass){if(this.elementClass instanceof Array){for(var i=0;i<this.elementClass.length;i++){target.classList.add(this.elementClass[i])}}else{target.classList.add(this.elementClass)}}target.style.display="";this.attach(target);this._opacity=null;this._currentTarget=target;this._stylesDirty=true;this._classesDirty=true;this._sizeDirty=true;this._contentDirty=true;this._originDirty=true;this._transformDirty=true};Surface.prototype.commit=function commit(context){if(!this._currentTarget)this.setup(context.allocator);var target=this._currentTarget;var size=context.size;if(this._classesDirty){_cleanupClasses.call(this,target);var classList=this.getClassList();for(var i=0;i<classList.length;i++)target.classList.add(classList[i]);this._classesDirty=false}if(this._stylesDirty){_applyStyles.call(this,target);this._stylesDirty=false}if(this.size){var origSize=context.size;size=[this.size[0],this.size[1]];if(size[0]===undefined)size[0]=origSize[0];else if(size[0]===true)size[0]=target.clientWidth;if(size[1]===undefined)size[1]=origSize[1];else if(size[1]===true)size[1]=target.clientHeight}if(_xyNotEquals(this._size,size)){if(!this._size)this._size=[0,0];this._size[0]=size[0];this._size[1]=size[1];this._sizeDirty=true}if(this._sizeDirty){if(this._size){target.style.width=this.size&&this.size[0]===true?"":this._size[0]+"px";target.style.height=this.size&&this.size[1]===true?"":this._size[1]+"px"}this._sizeDirty=false}if(this._contentDirty){this.deploy(target);this._eventOutput.emit("deploy");this._contentDirty=false}ElementOutput.prototype.commit.call(this,context)};Surface.prototype.cleanup=function cleanup(allocator){var i=0;var target=this._currentTarget;this._eventOutput.emit("recall");this.recall(target);target.style.display="none";target.style.opacity="";target.style.width="";target.style.height="";this._size=null;_cleanupStyles.call(this,target);var classList=this.getClassList();_cleanupClasses.call(this,target);for(i=0;i<classList.length;i++)target.classList.remove(classList[i]);if(this.elementClass){if(this.elementClass instanceof Array){for(i=0;i<this.elementClass.length;i++){target.classList.remove(this.elementClass[i])}}else{target.classList.remove(this.elementClass)}}this.detach(target);this._currentTarget=null;allocator.deallocate(target)};Surface.prototype.deploy=function deploy(target){var content=this.getContent();if(content instanceof Node){while(target.hasChildNodes())target.removeChild(target.firstChild);target.appendChild(content)}else target.innerHTML=content};Surface.prototype.recall=function recall(target){var df=document.createDocumentFragment();while(target.hasChildNodes())df.appendChild(target.firstChild);this.setContent(df)};Surface.prototype.getSize=function getSize(){return this._size};Surface.prototype.setSize=function setSize(size){this.size=size?[size[0],size[1]]:null;this._sizeDirty=true;return this};module.exports=Surface},{"./ElementOutput":3}],13:[function(require,module,exports){var Transform={};Transform.precision=1e-6;Transform.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Transform.multiply4x4=function multiply4x4(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]]};Transform.multiply=function multiply(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2],a[1]*b[0]+a[5]*b[1]+a[9]*b[2],a[2]*b[0]+a[6]*b[1]+a[10]*b[2],0,a[0]*b[4]+a[4]*b[5]+a[8]*b[6],a[1]*b[4]+a[5]*b[5]+a[9]*b[6],a[2]*b[4]+a[6]*b[5]+a[10]*b[6],0,a[0]*b[8]+a[4]*b[9]+a[8]*b[10],a[1]*b[8]+a[5]*b[9]+a[9]*b[10],a[2]*b[8]+a[6]*b[9]+a[10]*b[10],0,a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14],1]};Transform.thenMove=function thenMove(m,t){if(!t[2])t[2]=0;return[m[0],m[1],m[2],0,m[4],m[5],m[6],0,m[8],m[9],m[10],0,m[12]+t[0],m[13]+t[1],m[14]+t[2],1]};Transform.moveThen=function moveThen(v,m){if(!v[2])v[2]=0;var t0=v[0]*m[0]+v[1]*m[4]+v[2]*m[8];var t1=v[0]*m[1]+v[1]*m[5]+v[2]*m[9];var t2=v[0]*m[2]+v[1]*m[6]+v[2]*m[10];return Transform.thenMove(m,[t0,t1,t2])};Transform.translate=function translate(x,y,z){if(z===undefined)z=0;return[1,0,0,0,0,1,0,0,0,0,1,0,x,y,z,1]};Transform.thenScale=function thenScale(m,s){return[s[0]*m[0],s[1]*m[1],s[2]*m[2],0,s[0]*m[4],s[1]*m[5],s[2]*m[6],0,s[0]*m[8],s[1]*m[9],s[2]*m[10],0,s[0]*m[12],s[1]*m[13],s[2]*m[14],1]};Transform.scale=function scale(x,y,z){if(z===undefined)z=1;if(y===undefined)y=x;return[x,0,0,0,0,y,0,0,0,0,z,0,0,0,0,1]};Transform.rotateX=function rotateX(theta){var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);return[1,0,0,0,0,cosTheta,sinTheta,0,0,-sinTheta,cosTheta,0,0,0,0,1]};Transform.rotateY=function rotateY(theta){var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);return[cosTheta,0,-sinTheta,0,0,1,0,0,sinTheta,0,cosTheta,0,0,0,0,1]};Transform.rotateZ=function rotateZ(theta){var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);return[cosTheta,sinTheta,0,0,-sinTheta,cosTheta,0,0,0,0,1,0,0,0,0,1]};Transform.rotate=function rotate(phi,theta,psi){var cosPhi=Math.cos(phi);var sinPhi=Math.sin(phi);var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);var cosPsi=Math.cos(psi);var sinPsi=Math.sin(psi);var result=[cosTheta*cosPsi,cosPhi*sinPsi+sinPhi*sinTheta*cosPsi,sinPhi*sinPsi-cosPhi*sinTheta*cosPsi,0,-cosTheta*sinPsi,cosPhi*cosPsi-sinPhi*sinTheta*sinPsi,sinPhi*cosPsi+cosPhi*sinTheta*sinPsi,0,sinTheta,-sinPhi*cosTheta,cosPhi*cosTheta,0,0,0,0,1];return result};Transform.rotateAxis=function rotateAxis(v,theta){var sinTheta=Math.sin(theta);var cosTheta=Math.cos(theta);var verTheta=1-cosTheta;var xxV=v[0]*v[0]*verTheta;var xyV=v[0]*v[1]*verTheta;var xzV=v[0]*v[2]*verTheta;var yyV=v[1]*v[1]*verTheta;var yzV=v[1]*v[2]*verTheta;var zzV=v[2]*v[2]*verTheta;var xs=v[0]*sinTheta;var ys=v[1]*sinTheta;var zs=v[2]*sinTheta;var result=[xxV+cosTheta,xyV+zs,xzV-ys,0,xyV-zs,yyV+cosTheta,yzV+xs,0,xzV+ys,yzV-xs,zzV+cosTheta,0,0,0,0,1];return result};Transform.aboutOrigin=function aboutOrigin(v,m){var t0=v[0]-(v[0]*m[0]+v[1]*m[4]+v[2]*m[8]);var t1=v[1]-(v[0]*m[1]+v[1]*m[5]+v[2]*m[9]);var t2=v[2]-(v[0]*m[2]+v[1]*m[6]+v[2]*m[10]);return Transform.thenMove(m,[t0,t1,t2])};Transform.skew=function skew(phi,theta,psi){return[1,Math.tan(theta),0,0,Math.tan(psi),1,0,0,0,Math.tan(phi),1,0,0,0,0,1]};Transform.skewX=function skewX(angle){return[1,0,0,0,Math.tan(angle),1,0,0,0,0,1,0,0,0,0,1]};Transform.skewY=function skewY(angle){return[1,Math.tan(angle),0,0,0,1,0,0,0,0,1,0,0,0,0,1]};Transform.perspective=function perspective(focusZ){return[1,0,0,0,0,1,0,0,0,0,1,-1/focusZ,0,0,0,1]};Transform.getTranslate=function getTranslate(m){return[m[12],m[13],m[14]]};Transform.inverse=function inverse(m){var c0=m[5]*m[10]-m[6]*m[9];var c1=m[4]*m[10]-m[6]*m[8];var c2=m[4]*m[9]-m[5]*m[8];var c4=m[1]*m[10]-m[2]*m[9];var c5=m[0]*m[10]-m[2]*m[8];var c6=m[0]*m[9]-m[1]*m[8];var c8=m[1]*m[6]-m[2]*m[5];var c9=m[0]*m[6]-m[2]*m[4];var c10=m[0]*m[5]-m[1]*m[4];var detM=m[0]*c0-m[1]*c1+m[2]*c2;var invD=1/detM;var result=[invD*c0,-invD*c4,invD*c8,0,-invD*c1,invD*c5,-invD*c9,0,invD*c2,-invD*c6,invD*c10,0,0,0,0,1];result[12]=-m[12]*result[0]-m[13]*result[4]-m[14]*result[8];result[13]=-m[12]*result[1]-m[13]*result[5]-m[14]*result[9];result[14]=-m[12]*result[2]-m[13]*result[6]-m[14]*result[10];return result};Transform.transpose=function transpose(m){return[m[0],m[4],m[8],m[12],m[1],m[5],m[9],m[13],m[2],m[6],m[10],m[14],m[3],m[7],m[11],m[15]]};function _normSquared(v){return v.length===2?v[0]*v[0]+v[1]*v[1]:v[0]*v[0]+v[1]*v[1]+v[2]*v[2]}function _norm(v){return Math.sqrt(_normSquared(v))}function _sign(n){return n<0?-1:1}Transform.interpret=function interpret(M){var x=[M[0],M[1],M[2]];var sgn=_sign(x[0]);var xNorm=_norm(x);var v=[x[0]+sgn*xNorm,x[1],x[2]];var mult=2/_normSquared(v);if(mult>=Infinity){return{translate:Transform.getTranslate(M),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]}}var Q1=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];Q1[0]=1-mult*v[0]*v[0];Q1[5]=1-mult*v[1]*v[1];Q1[10]=1-mult*v[2]*v[2];Q1[1]=-mult*v[0]*v[1];Q1[2]=-mult*v[0]*v[2];Q1[6]=-mult*v[1]*v[2];Q1[4]=Q1[1];Q1[8]=Q1[2];Q1[9]=Q1[6];var MQ1=Transform.multiply(Q1,M);var x2=[MQ1[5],MQ1[6]];var sgn2=_sign(x2[0]);var x2Norm=_norm(x2);var v2=[x2[0]+sgn2*x2Norm,x2[1]];var mult2=2/_normSquared(v2);var Q2=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];Q2[5]=1-mult2*v2[0]*v2[0];Q2[10]=1-mult2*v2[1]*v2[1];Q2[6]=-mult2*v2[0]*v2[1];Q2[9]=Q2[6];var Q=Transform.multiply(Q2,Q1);var R=Transform.multiply(Q,M);var remover=Transform.scale(R[0]<0?-1:1,R[5]<0?-1:1,R[10]<0?-1:1);R=Transform.multiply(R,remover);Q=Transform.multiply(remover,Q);var result={};result.translate=Transform.getTranslate(M);result.rotate=[Math.atan2(-Q[6],Q[10]),Math.asin(Q[2]),Math.atan2(-Q[1],Q[0])];if(!result.rotate[0]){result.rotate[0]=0;result.rotate[2]=Math.atan2(Q[4],Q[5])}result.scale=[R[0],R[5],R[10]];result.skew=[Math.atan2(R[9],result.scale[2]),Math.atan2(R[8],result.scale[2]),Math.atan2(R[4],result.scale[0])];if(Math.abs(result.rotate[0])+Math.abs(result.rotate[2])>1.5*Math.PI){result.rotate[1]=Math.PI-result.rotate[1];if(result.rotate[1]>Math.PI)result.rotate[1]-=2*Math.PI;if(result.rotate[1]<-Math.PI)result.rotate[1]+=2*Math.PI;if(result.rotate[0]<0)result.rotate[0]+=Math.PI;else result.rotate[0]-=Math.PI;if(result.rotate[2]<0)result.rotate[2]+=Math.PI;else result.rotate[2]-=Math.PI}return result};Transform.average=function average(M1,M2,t){t=t===undefined?.5:t;var specM1=Transform.interpret(M1);var specM2=Transform.interpret(M2);var specAvg={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};for(var i=0;i<3;i++){specAvg.translate[i]=(1-t)*specM1.translate[i]+t*specM2.translate[i];specAvg.rotate[i]=(1-t)*specM1.rotate[i]+t*specM2.rotate[i];specAvg.scale[i]=(1-t)*specM1.scale[i]+t*specM2.scale[i];specAvg.skew[i]=(1-t)*specM1.skew[i]+t*specM2.skew[i]}return Transform.build(specAvg)};Transform.build=function build(spec){var scaleMatrix=Transform.scale(spec.scale[0],spec.scale[1],spec.scale[2]);var skewMatrix=Transform.skew(spec.skew[0],spec.skew[1],spec.skew[2]);var rotateMatrix=Transform.rotate(spec.rotate[0],spec.rotate[1],spec.rotate[2]);return Transform.thenMove(Transform.multiply(Transform.multiply(rotateMatrix,skewMatrix),scaleMatrix),spec.translate)};Transform.equals=function equals(a,b){return!Transform.notEquals(a,b)};Transform.notEquals=function notEquals(a,b){if(a===b)return false;return!(a&&b)||a[12]!==b[12]||a[13]!==b[13]||a[14]!==b[14]||a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[4]!==b[4]||a[5]!==b[5]||a[6]!==b[6]||a[8]!==b[8]||a[9]!==b[9]||a[10]!==b[10]};Transform.normalizeRotation=function normalizeRotation(rotation){var result=rotation.slice(0);if(result[0]===Math.PI*.5||result[0]===-Math.PI*.5){result[0]=-result[0];result[1]=Math.PI-result[1];result[2]-=Math.PI}if(result[0]>Math.PI*.5){result[0]=result[0]-Math.PI;result[1]=Math.PI-result[1];result[2]-=Math.PI}if(result[0]<-Math.PI*.5){result[0]=result[0]+Math.PI;result[1]=-Math.PI-result[1];result[2]-=Math.PI}while(result[1]<-Math.PI)result[1]+=2*Math.PI;while(result[1]>=Math.PI)result[1]-=2*Math.PI;while(result[2]<-Math.PI)result[2]+=2*Math.PI;while(result[2]>=Math.PI)result[2]-=2*Math.PI;return result};Transform.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1];Transform.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1];module.exports=Transform},{}],14:[function(require,module,exports){var EventHandler=require("./EventHandler");var OptionsManager=require("./OptionsManager");var RenderNode=require("./RenderNode");var Utility=require("famous/utilities/Utility");function View(options){this._node=new RenderNode;this._eventInput=new EventHandler;this._eventOutput=new EventHandler;EventHandler.setInputHandler(this,this._eventInput);EventHandler.setOutputHandler(this,this._eventOutput);this.options=Utility.clone(this.constructor.DEFAULT_OPTIONS||View.DEFAULT_OPTIONS);this._optionsManager=new OptionsManager(this.options);if(options)this.setOptions(options)}View.DEFAULT_OPTIONS={};View.prototype.getOptions=function getOptions(){return this._optionsManager.value()};View.prototype.setOptions=function setOptions(options){this._optionsManager.patch(options)};View.prototype.add=function add(){return this._node.add.apply(this._node,arguments)};View.prototype._add=View.prototype.add;View.prototype.render=function render(){return this._node.render()};View.prototype.getSize=function getSize(){if(this._node&&this._node.getSize){return this._node.getSize.apply(this._node,arguments)||this.options.size}else return this.options.size};module.exports=View},{"./EventHandler":7,"./OptionsManager":9,"./RenderNode":10,"famous/utilities/Utility":42}],15:[function(require,module,exports){function ViewSequence(options){if(!options)options=[];if(options instanceof Array)options={array:options};this._=null;this.index=options.index||0;if(options.array)this._=new this.constructor.Backing(options.array);else if(options._)this._=options._;if(this.index===this._.firstIndex)this._.firstNode=this;if(this.index===this._.firstIndex+this._.array.length-1)this._.lastNode=this;if(options.loop!==undefined)this._.loop=options.loop;this._previousNode=null;this._nextNode=null}ViewSequence.Backing=function Backing(array){this.array=array;this.firstIndex=0;this.loop=false;this.firstNode=null;this.lastNode=null};ViewSequence.Backing.prototype.getValue=function getValue(i){var _i=i-this.firstIndex;if(_i<0||_i>=this.array.length)return null;return this.array[_i]};ViewSequence.Backing.prototype.setValue=function setValue(i,value){this.array[i-this.firstIndex]=value};ViewSequence.Backing.prototype.reindex=function reindex(start,removeCount,insertCount){if(!this.array[0])return;var i=0;var index=this.firstIndex;var indexShiftAmount=insertCount-removeCount;var node=this.firstNode;while(index<start-1){node=node.getNext();index++}var spliceStartNode=node;for(i=0;i<removeCount;i++){node=node.getNext();if(node)node._previousNode=spliceStartNode}var spliceResumeNode=node?node.getNext():null;spliceStartNode._nextNode=null;node=spliceStartNode;for(i=0;i<insertCount;i++)node=node.getNext();index+=insertCount;if(node!==spliceResumeNode){node._nextNode=spliceResumeNode;if(spliceResumeNode)spliceResumeNode._previousNode=node}if(spliceResumeNode){node=spliceResumeNode;index++;while(node&&index<this.array.length+this.firstIndex){if(node._nextNode)node.index+=indexShiftAmount;else node.index=index;node=node.getNext();index++}}};ViewSequence.prototype.getPrevious=function getPrevious(){if(this.index===this._.firstIndex){if(this._.loop){this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+this._.array.length-1});this._previousNode._nextNode=this}else{this._previousNode=null}}else if(!this._previousNode){this._previousNode=new this.constructor({_:this._,index:this.index-1});this._previousNode._nextNode=this}return this._previousNode};ViewSequence.prototype.getNext=function getNext(){if(this.index===this._.firstIndex+this._.array.length-1){if(this._.loop){this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex});this._nextNode._previousNode=this}else{this._nextNode=null}}else if(!this._nextNode){this._nextNode=new this.constructor({_:this._,index:this.index+1});this._nextNode._previousNode=this}return this._nextNode};ViewSequence.prototype.getIndex=function getIndex(){return this.index};ViewSequence.prototype.toString=function toString(){return""+this.index};ViewSequence.prototype.unshift=function unshift(value){this._.array.unshift.apply(this._.array,arguments);this._.firstIndex-=arguments.length};ViewSequence.prototype.push=function push(value){this._.array.push.apply(this._.array,arguments)};ViewSequence.prototype.splice=function splice(index,howMany){var values=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[index-this._.firstIndex,howMany].concat(values));this._.reindex(index,howMany,values.length)};ViewSequence.prototype.swap=function swap(other){var otherValue=other.get();var myValue=this.get();this._.setValue(this.index,otherValue);this._.setValue(other.index,myValue);var myPrevious=this._previousNode;var myNext=this._nextNode;var myIndex=this.index;var otherPrevious=other._previousNode;var otherNext=other._nextNode;var otherIndex=other.index;this.index=otherIndex;this._previousNode=otherPrevious===this?other:otherPrevious;if(this._previousNode)this._previousNode._nextNode=this;this._nextNode=otherNext===this?other:otherNext;if(this._nextNode)this._nextNode._previousNode=this;other.index=myIndex;other._previousNode=myPrevious===other?this:myPrevious;if(other._previousNode)other._previousNode._nextNode=other;other._nextNode=myNext===other?this:myNext;if(other._nextNode)other._nextNode._previousNode=other;if(this.index===this._.firstIndex)this._.firstNode=this;else if(this.index===this._.firstIndex+this._.array.length-1)this._.lastNode=this;if(other.index===this._.firstIndex)this._.firstNode=other;else if(other.index===this._.firstIndex+this._.array.length-1)this._.lastNode=other};ViewSequence.prototype.get=function get(){return this._.getValue(this.index)};ViewSequence.prototype.getSize=function getSize(){var target=this.get();return target?target.getSize():null};ViewSequence.prototype.render=function render(){var target=this.get();return target?target.render.apply(target,arguments):null};module.exports=ViewSequence},{}],16:[function(require,module,exports){(function(){if(!window.CustomEvent)return;var clickThreshold=300;var clickWindow=500;var potentialClicks={};var recentlyDispatched={};var _now=Date.now;window.addEventListener("touchstart",function(event){var timestamp=_now();for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];potentialClicks[touch.identifier]=timestamp}});window.addEventListener("touchmove",function(event){for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];delete potentialClicks[touch.identifier]}});window.addEventListener("touchend",function(event){var currTime=_now();for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];var startTime=potentialClicks[touch.identifier];if(startTime&&currTime-startTime<clickThreshold){var clickEvt=new window.CustomEvent("click",{bubbles:true,detail:touch});recentlyDispatched[currTime]=event;event.target.dispatchEvent(clickEvt)}delete potentialClicks[touch.identifier]}});window.addEventListener("click",function(event){var currTime=_now();for(var i in recentlyDispatched){var previousEvent=recentlyDispatched[i];if(currTime-i<clickWindow){if(event instanceof window.MouseEvent&&event.target===previousEvent.target)event.stopPropagation()}else delete recentlyDispatched[i]}},true)})()},{}],17:[function(require,module,exports){var EventHandler=require("../core/EventHandler");function GenericSync(syncs,options){this._eventInput=new EventHandler;this._eventOutput=new EventHandler;EventHandler.setInputHandler(this,this._eventInput);EventHandler.setOutputHandler(this,this._eventOutput);this._syncs={};if(syncs)this.addSync(syncs);if(options)this.setOptions(options)}GenericSync.DIRECTION_X=0;GenericSync.DIRECTION_Y=1;GenericSync.DIRECTION_Z=2;var registry={};GenericSync.register=function register(syncObject){for(var key in syncObject){if(registry[key]){if(registry[key]===syncObject[key])return;else throw new Error("this key is registered to a different sync class")}else registry[key]=syncObject[key]}};GenericSync.prototype.setOptions=function(options){for(var key in this._syncs){this._syncs[key].setOptions(options)}};GenericSync.prototype.pipeSync=function pipeToSync(key){var sync=this._syncs[key];this._eventInput.pipe(sync);sync.pipe(this._eventOutput)};GenericSync.prototype.unpipeSync=function unpipeFromSync(key){var sync=this._syncs[key];this._eventInput.unpipe(sync);sync.unpipe(this._eventOutput)};function _addSingleSync(key,options){if(!registry[key])return;this._syncs[key]=new registry[key](options);this.pipeSync(key)}GenericSync.prototype.addSync=function addSync(syncs){if(syncs instanceof Array)for(var i=0;i<syncs.length;i++)_addSingleSync.call(this,syncs[i]);else if(syncs instanceof Object)for(var key in syncs)_addSingleSync.call(this,key,syncs[key])};module.exports=GenericSync},{"../core/EventHandler":7}],18:[function(require,module,exports){var EventHandler=require("../core/EventHandler");var OptionsManager=require("../core/OptionsManager");function MouseSync(options){this.options=Object.create(MouseSync.DEFAULT_OPTIONS);this._optionsManager=new OptionsManager(this.options);if(options)this.setOptions(options);this._eventInput=new EventHandler;this._eventOutput=new EventHandler;EventHandler.setInputHandler(this,this._eventInput);EventHandler.setOutputHandler(this,this._eventOutput);this._eventInput.on("mousedown",_handleStart.bind(this));this._eventInput.on("mousemove",_handleMove.bind(this));this._eventInput.on("mouseup",_handleEnd.bind(this));if(this.options.propogate)this._eventInput.on("mouseleave",_handleLeave.bind(this));else this._eventInput.on("mouseleave",_handleEnd.bind(this));this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0};this._position=null;this._prevCoord=undefined;this._prevTime=undefined;this._down=false;this._moved=false}MouseSync.DEFAULT_OPTIONS={direction:undefined,rails:false,scale:1,propogate:true,preventDefault:true};MouseSync.DIRECTION_X=0;MouseSync.DIRECTION_Y=1;var MINIMUM_TICK_TIME=8;var _now=Date.now;function _handleStart(event){var delta;var velocity;if(this.options.preventDefault)event.preventDefault();var x=event.clientX;var y=event.clientY;this._prevCoord=[x,y];this._prevTime=_now();this._down=true;this._move=false;if(this.options.direction!==undefined){this._position=0;delta=0;velocity=0}else{this._position=[0,0];delta=[0,0];velocity=[0,0]}var payload=this._payload;payload.delta=delta;payload.position=this._position;payload.velocity=velocity;payload.clientX=x;payload.clientY=y;payload.offsetX=event.offsetX;payload.offsetY=event.offsetY;this._eventOutput.emit("start",payload)}function _handleMove(event){if(!this._prevCoord)return;var prevCoord=this._prevCoord;var prevTime=this._prevTime;var x=event.clientX;var y=event.clientY;var currTime=_now();var diffX=x-prevCoord[0];var diffY=y-prevCoord[1];if(this.options.rails){if(Math.abs(diffX)>Math.abs(diffY))diffY=0;else diffX=0}var diffTime=Math.max(currTime-prevTime,MINIMUM_TICK_TIME);var velX=diffX/diffTime;var velY=diffY/diffTime;var scale=this.options.scale;var nextVel;var nextDelta;if(this.options.direction===MouseSync.DIRECTION_X){nextDelta=scale*diffX;nextVel=scale*velX;this._position+=nextDelta}else if(this.options.direction===MouseSync.DIRECTION_Y){nextDelta=scale*diffY;nextVel=scale*velY;this._position+=nextDelta}else{nextDelta=[scale*diffX,scale*diffY];nextVel=[scale*velX,scale*velY];this._position[0]+=nextDelta[0];this._position[1]+=nextDelta[1]}var payload=this._payload;payload.delta=nextDelta;payload.position=this._position;payload.velocity=nextVel;payload.clientX=x;payload.clientY=y;payload.offsetX=event.offsetX;payload.offsetY=event.offsetY;this._eventOutput.emit("update",payload);this._prevCoord=[x,y];this._prevTime=currTime;this._move=true}function _handleEnd(event){if(!this._down)return;this._eventOutput.emit("end",this._payload);this._prevCoord=undefined;this._prevTime=undefined;this._down=false;this._move=false}function _handleLeave(event){if(!this._down||!this._move)return;var boundMove=_handleMove.bind(this);var boundEnd=function(event){_handleEnd.call(this,event);document.removeEventListener("mousemove",boundMove);document.removeEventListener("mouseup",boundEnd)}.bind(this,event);document.addEventListener("mousemove",boundMove);document.addEventListener("mouseup",boundEnd)}MouseSync.prototype.getOptions=function getOptions(){return this.options};MouseSync.prototype.setOptions=function setOptions(options){return this._optionsManager.setOptions(options)};module.exports=MouseSync},{"../core/EventHandler":7,"../core/OptionsManager":9}],19:[function(require,module,exports){var EventHandler=require("../core/EventHandler");var Engine=require("../core/Engine");var OptionsManager=require("../core/OptionsManager");function ScrollSync(options){this.options=Object.create(ScrollSync.DEFAULT_OPTIONS);this._optionsManager=new OptionsManager(this.options);if(options)this.setOptions(options);this._payload={delta:null,position:null,velocity:null,slip:true};this._eventInput=new EventHandler;this._eventOutput=new EventHandler;EventHandler.setInputHandler(this,this._eventInput);EventHandler.setOutputHandler(this,this._eventOutput);this._position=this.options.direction===undefined?[0,0]:0;this._prevTime=undefined;this._prevVel=undefined;this._eventInput.on("mousewheel",_handleMove.bind(this));this._eventInput.on("wheel",_handleMove.bind(this));this._inProgress=false;this._loopBound=false}ScrollSync.DEFAULT_OPTIONS={direction:undefined,minimumEndSpeed:Infinity,rails:false,scale:1,stallTime:50,lineHeight:40,preventDefault:true};ScrollSync.DIRECTION_X=0;ScrollSync.DIRECTION_Y=1;var MINIMUM_TICK_TIME=8;var _now=Date.now;function _newFrame(){if(this._inProgress&&_now()-this._prevTime>this.options.stallTime){this._inProgress=false;var finalVel=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0;var payload=this._payload;payload.position=this._position;payload.velocity=finalVel;payload.slip=true;this._eventOutput.emit("end",payload)}}function _handleMove(event){if(this.options.preventDefault)event.preventDefault();if(!this._inProgress){this._inProgress=true;this._position=this.options.direction===undefined?[0,0]:0;payload=this._payload;payload.slip=true;payload.position=this._position;payload.clientX=event.clientX;payload.clientY=event.clientY;payload.offsetX=event.offsetX;payload.offsetY=event.offsetY;this._eventOutput.emit("start",payload);if(!this._loopBound){Engine.on("prerender",_newFrame.bind(this));this._loopBound=true}}var currTime=_now();var prevTime=this._prevTime||currTime;var diffX=event.wheelDeltaX!==undefined?event.wheelDeltaX:-event.deltaX;var diffY=event.wheelDeltaY!==undefined?event.wheelDeltaY:-event.deltaY;if(event.deltaMode===1){diffX*=this.options.lineHeight;diffY*=this.options.lineHeight}if(this.options.rails){if(Math.abs(diffX)>Math.abs(diffY))diffY=0;else diffX=0}var diffTime=Math.max(currTime-prevTime,MINIMUM_TICK_TIME);var velX=diffX/diffTime;var velY=diffY/diffTime;var scale=this.options.scale;var nextVel;var nextDelta;if(this.options.direction===ScrollSync.DIRECTION_X){nextDelta=scale*diffX;nextVel=scale*velX;this._position+=nextDelta}else if(this.options.direction===ScrollSync.DIRECTION_Y){nextDelta=scale*diffY;nextVel=scale*velY;this._position+=nextDelta}else{nextDelta=[scale*diffX,scale*diffY];nextVel=[scale*velX,scale*velY];this._position[0]+=nextDelta[0];this._position[1]+=nextDelta[1]}var payload=this._payload;payload.delta=nextDelta;payload.velocity=nextVel;payload.position=this._position;payload.slip=true;this._eventOutput.emit("update",payload);this._prevTime=currTime;this._prevVel=nextVel}ScrollSync.prototype.getOptions=function getOptions(){return this.options};ScrollSync.prototype.setOptions=function setOptions(options){return this._optionsManager.setOptions(options)};module.exports=ScrollSync},{"../core/Engine":4,"../core/EventHandler":7,"../core/OptionsManager":9}],20:[function(require,module,exports){var TouchTracker=require("./TouchTracker");var EventHandler=require("../core/EventHandler");var OptionsManager=require("../core/OptionsManager");function TouchSync(options){this.options=Object.create(TouchSync.DEFAULT_OPTIONS);this._optionsManager=new OptionsManager(this.options);if(options)this.setOptions(options);this._eventOutput=new EventHandler;this._touchTracker=new TouchTracker;EventHandler.setOutputHandler(this,this._eventOutput);EventHandler.setInputHandler(this,this._touchTracker);this._touchTracker.on("trackstart",_handleStart.bind(this));this._touchTracker.on("trackmove",_handleMove.bind(this));this._touchTracker.on("trackend",_handleEnd.bind(this));this._payload={delta:null,position:null,velocity:null,clientX:undefined,clientY:undefined,count:0,touch:undefined};this._position=null}TouchSync.DEFAULT_OPTIONS={direction:undefined,rails:false,scale:1};TouchSync.DIRECTION_X=0;TouchSync.DIRECTION_Y=1;var MINIMUM_TICK_TIME=8;function _handleStart(data){var velocity;var delta;if(this.options.direction!==undefined){this._position=0;velocity=0;delta=0}else{this._position=[0,0];velocity=[0,0];delta=[0,0]}var payload=this._payload;payload.delta=delta;payload.position=this._position;payload.velocity=velocity;payload.clientX=data.x;payload.clientY=data.y;payload.count=data.count;payload.touch=data.identifier;this._eventOutput.emit("start",payload)}function _handleMove(data){var history=data.history;var currHistory=history[history.length-1];var prevHistory=history[history.length-2];var prevTime=prevHistory.timestamp;var currTime=currHistory.timestamp;var diffX=currHistory.x-prevHistory.x;var diffY=currHistory.y-prevHistory.y;if(this.options.rails){if(Math.abs(diffX)>Math.abs(diffY))diffY=0;else diffX=0}var diffTime=Math.max(currTime-prevTime,MINIMUM_TICK_TIME);var velX=diffX/diffTime;var velY=diffY/diffTime;var scale=this.options.scale;var nextVel;var nextDelta;if(this.options.direction===TouchSync.DIRECTION_X){nextDelta=scale*diffX;nextVel=scale*velX;this._position+=nextDelta}else if(this.options.direction===TouchSync.DIRECTION_Y){nextDelta=scale*diffY;nextVel=scale*velY;this._position+=nextDelta}else{nextDelta=[scale*diffX,scale*diffY];nextVel=[scale*velX,scale*velY];this._position[0]+=nextDelta[0];this._position[1]+=nextDelta[1]}var payload=this._payload;payload.delta=nextDelta;payload.velocity=nextVel;payload.position=this._position;payload.clientX=data.x;payload.clientY=data.y;payload.count=data.count;payload.touch=data.identifier;this._eventOutput.emit("update",payload)}function _handleEnd(data){this._payload.count=data.count;this._eventOutput.emit("end",this._payload)}TouchSync.prototype.setOptions=function setOptions(options){return this._optionsManager.setOptions(options)
};TouchSync.prototype.getOptions=function getOptions(){return this.options};module.exports=TouchSync},{"../core/EventHandler":7,"../core/OptionsManager":9,"./TouchTracker":21}],21:[function(require,module,exports){var EventHandler=require("../core/EventHandler");var _now=Date.now;function _timestampTouch(touch,event,history){return{x:touch.clientX,y:touch.clientY,identifier:touch.identifier,origin:event.origin,timestamp:_now(),count:event.touches.length,history:history}}function _handleStart(event){for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];var data=_timestampTouch(touch,event,null);this.eventOutput.emit("trackstart",data);if(!this.selective&&!this.touchHistory[touch.identifier])this.track(data)}}function _handleMove(event){for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];var history=this.touchHistory[touch.identifier];if(history){var data=_timestampTouch(touch,event,history);this.touchHistory[touch.identifier].push(data);this.eventOutput.emit("trackmove",data)}}}function _handleEnd(event){for(var i=0;i<event.changedTouches.length;i++){var touch=event.changedTouches[i];var history=this.touchHistory[touch.identifier];if(history){var data=_timestampTouch(touch,event,history);this.eventOutput.emit("trackend",data);delete this.touchHistory[touch.identifier]}}}function _handleUnpipe(){for(var i in this.touchHistory){var history=this.touchHistory[i];this.eventOutput.emit("trackend",{touch:history[history.length-1].touch,timestamp:Date.now(),count:0,history:history});delete this.touchHistory[i]}}function TouchTracker(selective){this.selective=selective;this.touchHistory={};this.eventInput=new EventHandler;this.eventOutput=new EventHandler;EventHandler.setInputHandler(this,this.eventInput);EventHandler.setOutputHandler(this,this.eventOutput);this.eventInput.on("touchstart",_handleStart.bind(this));this.eventInput.on("touchmove",_handleMove.bind(this));this.eventInput.on("touchend",_handleEnd.bind(this));this.eventInput.on("touchcancel",_handleEnd.bind(this));this.eventInput.on("unpipe",_handleUnpipe.bind(this))}TouchTracker.prototype.track=function track(data){this.touchHistory[data.identifier]=[data]};module.exports=TouchTracker},{"../core/EventHandler":7}],22:[function(require,module,exports){function Vector(x,y,z){if(arguments.length===1&&x!==undefined)this.set(x);else{this.x=x||0;this.y=y||0;this.z=z||0}return this}var _register=new Vector(0,0,0);Vector.prototype.add=function add(v){return _setXYZ.call(_register,this.x+v.x,this.y+v.y,this.z+v.z)};Vector.prototype.sub=function sub(v){return _setXYZ.call(_register,this.x-v.x,this.y-v.y,this.z-v.z)};Vector.prototype.mult=function mult(r){return _setXYZ.call(_register,r*this.x,r*this.y,r*this.z)};Vector.prototype.div=function div(r){return this.mult(1/r)};Vector.prototype.cross=function cross(v){var x=this.x;var y=this.y;var z=this.z;var vx=v.x;var vy=v.y;var vz=v.z;return _setXYZ.call(_register,z*vy-y*vz,x*vz-z*vx,y*vx-x*vy)};Vector.prototype.equals=function equals(v){return v.x===this.x&&v.y===this.y&&v.z===this.z};Vector.prototype.rotateX=function rotateX(theta){var x=this.x;var y=this.y;var z=this.z;var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);return _setXYZ.call(_register,x,y*cosTheta-z*sinTheta,y*sinTheta+z*cosTheta)};Vector.prototype.rotateY=function rotateY(theta){var x=this.x;var y=this.y;var z=this.z;var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);return _setXYZ.call(_register,z*sinTheta+x*cosTheta,y,z*cosTheta-x*sinTheta)};Vector.prototype.rotateZ=function rotateZ(theta){var x=this.x;var y=this.y;var z=this.z;var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);return _setXYZ.call(_register,x*cosTheta-y*sinTheta,x*sinTheta+y*cosTheta,z)};Vector.prototype.dot=function dot(v){return this.x*v.x+this.y*v.y+this.z*v.z};Vector.prototype.normSquared=function normSquared(){return this.dot(this)};Vector.prototype.norm=function norm(){return Math.sqrt(this.normSquared())};Vector.prototype.normalize=function normalize(length){if(arguments.length===0)length=1;var norm=this.norm();if(norm>1e-7)return _setFromVector.call(_register,this.mult(length/norm));else return _setXYZ.call(_register,length,0,0)};Vector.prototype.clone=function clone(){return new Vector(this)};Vector.prototype.isZero=function isZero(){return!(this.x||this.y||this.z)};function _setXYZ(x,y,z){this.x=x;this.y=y;this.z=z;return this}function _setFromArray(v){return _setXYZ.call(this,v[0],v[1],v[2]||0)}function _setFromVector(v){return _setXYZ.call(this,v.x,v.y,v.z)}function _setFromNumber(x){return _setXYZ.call(this,x,0,0)}Vector.prototype.set=function set(v){if(v instanceof Array)return _setFromArray.call(this,v);if(typeof v==="number")return _setFromNumber.call(this,v);return _setFromVector.call(this,v)};Vector.prototype.setXYZ=function(x,y,z){return _setXYZ.apply(this,arguments)};Vector.prototype.set1D=function(x){return _setFromNumber.call(this,x)};Vector.prototype.put=function put(v){if(this===_register)_setFromVector.call(v,_register);else _setFromVector.call(v,this)};Vector.prototype.clear=function clear(){return _setXYZ.call(this,0,0,0)};Vector.prototype.cap=function cap(cap){if(cap===Infinity)return _setFromVector.call(_register,this);var norm=this.norm();if(norm>cap)return _setFromVector.call(_register,this.mult(cap/norm));else return _setFromVector.call(_register,this)};Vector.prototype.project=function project(n){return n.mult(this.dot(n))};Vector.prototype.reflectAcross=function reflectAcross(n){n.normalize().put(n);return _setFromVector(_register,this.sub(this.project(n).mult(2)))};Vector.prototype.get=function get(){return[this.x,this.y,this.z]};Vector.prototype.get1D=function(){return this.x};module.exports=Vector},{}],23:[function(require,module,exports){var EventHandler=require("famous/core/EventHandler");function PhysicsEngine(options){this.options=Object.create(PhysicsEngine.DEFAULT_OPTIONS);if(options)this.setOptions(options);this._particles=[];this._bodies=[];this._agents={};this._forces=[];this._constraints=[];this._buffer=0;this._prevTime=now();this._isSleeping=false;this._eventHandler=null;this._currAgentId=0;this._hasBodies=false}var TIMESTEP=17;var MIN_TIME_STEP=1e3/120;var MAX_TIME_STEP=17;PhysicsEngine.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7};var now=function(){return Date.now}();PhysicsEngine.prototype.setOptions=function setOptions(opts){for(var key in opts)if(this.options[key])this.options[key]=opts[key]};PhysicsEngine.prototype.addBody=function addBody(body){body._engine=this;if(body.isBody){this._bodies.push(body);this._hasBodies=true}else this._particles.push(body);return body};PhysicsEngine.prototype.removeBody=function removeBody(body){var array=body.isBody?this._bodies:this._particles;var index=array.indexOf(body);if(index>-1){for(var i=0;i<Object.keys(this._agents).length;i++)this.detachFrom(i,body);array.splice(index,1)}if(this.getBodies().length===0)this._hasBodies=false};function _mapAgentArray(agent){if(agent.applyForce)return this._forces;if(agent.applyConstraint)return this._constraints}function _attachOne(agent,targets,source){if(targets===undefined)targets=this.getParticlesAndBodies();if(!(targets instanceof Array))targets=[targets];this._agents[this._currAgentId]={agent:agent,targets:targets,source:source};_mapAgentArray.call(this,agent).push(this._currAgentId);return this._currAgentId++}PhysicsEngine.prototype.attach=function attach(agents,targets,source){if(agents instanceof Array){var agentIDs=[];for(var i=0;i<agents.length;i++)agentIDs[i]=_attachOne.call(this,agents[i],targets,source);return agentIDs}else return _attachOne.call(this,agents,targets,source)};PhysicsEngine.prototype.attachTo=function attachTo(agentID,target){_getBoundAgent.call(this,agentID).targets.push(target)};PhysicsEngine.prototype.detach=function detach(id){var agent=this.getAgent(id);var agentArray=_mapAgentArray.call(this,agent);var index=agentArray.indexOf(id);agentArray.splice(index,1);delete this._agents[id]};PhysicsEngine.prototype.detachFrom=function detachFrom(id,target){var boundAgent=_getBoundAgent.call(this,id);if(boundAgent.source===target)this.detach(id);else{var targets=boundAgent.targets;var index=targets.indexOf(target);if(index>-1)targets.splice(index,1)}};PhysicsEngine.prototype.detachAll=function detachAll(){this._agents={};this._forces=[];this._constraints=[];this._currAgentId=0};function _getBoundAgent(id){return this._agents[id]}PhysicsEngine.prototype.getAgent=function getAgent(id){return _getBoundAgent.call(this,id).agent};PhysicsEngine.prototype.getParticles=function getParticles(){return this._particles};PhysicsEngine.prototype.getBodies=function getBodies(){return this._bodies};PhysicsEngine.prototype.getParticlesAndBodies=function getParticlesAndBodies(){return this.getParticles().concat(this.getBodies())};PhysicsEngine.prototype.forEachParticle=function forEachParticle(fn,dt){var particles=this.getParticles();for(var index=0,len=particles.length;index<len;index++)fn.call(this,particles[index],dt)};PhysicsEngine.prototype.forEachBody=function forEachBody(fn,dt){if(!this._hasBodies)return;var bodies=this.getBodies();for(var index=0,len=bodies.length;index<len;index++)fn.call(this,bodies[index],dt)};PhysicsEngine.prototype.forEach=function forEach(fn,dt){this.forEachParticle(fn,dt);this.forEachBody(fn,dt)};function _updateForce(index){var boundAgent=_getBoundAgent.call(this,this._forces[index]);boundAgent.agent.applyForce(boundAgent.targets,boundAgent.source)}function _updateForces(){for(var index=this._forces.length-1;index>-1;index--)_updateForce.call(this,index)}function _updateConstraint(index,dt){var boundAgent=this._agents[this._constraints[index]];return boundAgent.agent.applyConstraint(boundAgent.targets,boundAgent.source,dt)}function _updateConstraints(dt){var iteration=0;while(iteration<this.options.constraintSteps){for(var index=this._constraints.length-1;index>-1;index--)_updateConstraint.call(this,index,dt);iteration++}}function _updateVelocities(particle,dt){particle.integrateVelocity(dt)}function _updateAngularVelocities(body,dt){body.integrateAngularMomentum(dt);body.updateAngularVelocity()}function _updateOrientations(body,dt){body.integrateOrientation(dt)}function _updatePositions(particle,dt){particle.integratePosition(dt);particle.emit("update",particle)}function _integrate(dt){_updateForces.call(this,dt);this.forEach(_updateVelocities,dt);this.forEachBody(_updateAngularVelocities,dt);_updateConstraints.call(this,dt);this.forEachBody(_updateOrientations,dt);this.forEach(_updatePositions,dt)}function _getEnergyParticles(){var energy=0;var particleEnergy=0;this.forEach(function(particle){particleEnergy=particle.getEnergy();energy+=particleEnergy;if(particleEnergy<particle.sleepTolerance)particle.sleep()});return energy}function _getEnergyForces(){var energy=0;for(var index=this._forces.length-1;index>-1;index--)energy+=this._forces[index].getEnergy()||0;return energy}function _getEnergyConstraints(){var energy=0;for(var index=this._constraints.length-1;index>-1;index--)energy+=this._constraints[index].getEnergy()||0;return energy}PhysicsEngine.prototype.getEnergy=function getEnergy(){return _getEnergyParticles.call(this)+_getEnergyForces.call(this)+_getEnergyConstraints.call(this)};PhysicsEngine.prototype.step=function step(){var currTime=now();var dtFrame=currTime-this._prevTime;this._prevTime=currTime;if(dtFrame<MIN_TIME_STEP)return;if(dtFrame>MAX_TIME_STEP)dtFrame=MAX_TIME_STEP;_integrate.call(this,TIMESTEP)};PhysicsEngine.prototype.isSleeping=function isSleeping(){return this._isSleeping};PhysicsEngine.prototype.sleep=function sleep(){this.emit("end",this);this._isSleeping=true};PhysicsEngine.prototype.wake=function wake(){this._prevTime=now();this.emit("start",this);this._isSleeping=false};PhysicsEngine.prototype.emit=function emit(type,data){if(this._eventHandler===null)return;this._eventHandler.emit(type,data)};PhysicsEngine.prototype.on=function on(event,fn){if(this._eventHandler===null)this._eventHandler=new EventHandler;this._eventHandler.on(event,fn)};module.exports=PhysicsEngine},{"famous/core/EventHandler":7}],24:[function(require,module,exports){var Vector=require("famous/math/Vector");var Transform=require("famous/core/Transform");var EventHandler=require("famous/core/EventHandler");var Integrator=require("../integrators/SymplecticEuler");function Particle(options){options=options||{};this.position=new Vector;this.velocity=new Vector;this.force=new Vector;var defaults=Particle.DEFAULT_OPTIONS;this.setPosition(options.position||defaults.position);this.setVelocity(options.velocity||defaults.velocity);this.force.set(options.force||[0,0,0]);this.mass=options.mass!==undefined?options.mass:defaults.mass;this.axis=options.axis!==undefined?options.axis:defaults.axis;this.inverseMass=1/this.mass;this._isSleeping=false;this._engine=null;this._eventOutput=null;this._positionGetter=null;this.transform=Transform.identity.slice();this._spec={transform:this.transform,target:null}}Particle.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1,axis:undefined};Particle.SLEEP_TOLERANCE=1e-7;Particle.AXES={X:0,Y:1,Z:2};Particle.INTEGRATOR=new Integrator;var _events={start:"start",update:"update",end:"end"};var now=function(){return Date.now}();Particle.prototype.sleep=function sleep(){if(this._isSleeping)return;this.emit(_events.end,this);this._isSleeping=true};Particle.prototype.wake=function wake(){if(!this._isSleeping)return;this.emit(_events.start,this);this._isSleeping=false;this._prevTime=now()};Particle.prototype.isBody=false;Particle.prototype.setPosition=function setPosition(position){this.position.set(position)};Particle.prototype.setPosition1D=function setPosition1D(x){this.position.x=x};Particle.prototype.getPosition=function getPosition(){if(this._positionGetter instanceof Function)this.setPosition(this._positionGetter());this._engine.step();return this.position.get()};Particle.prototype.getPosition1D=function getPosition1D(){this._engine.step();return this.position.x};Particle.prototype.positionFrom=function positionFrom(positionGetter){this._positionGetter=positionGetter};Particle.prototype.setVelocity=function setVelocity(velocity){this.velocity.set(velocity);this.wake()};Particle.prototype.setVelocity1D=function setVelocity1D(x){this.velocity.x=x;this.wake()};Particle.prototype.getVelocity=function getVelocity(){return this.velocity.get()};Particle.prototype.getVelocity1D=function getVelocity1D(){return this.velocity.x};Particle.prototype.setMass=function setMass(mass){this.mass=mass;this.inverseMass=1/mass};Particle.prototype.getMass=function getMass(){return this.mass};Particle.prototype.reset=function reset(position,velocity){this.setPosition(position||[0,0,0]);this.setVelocity(velocity||[0,0,0])};Particle.prototype.applyForce=function applyForce(force){if(force.isZero())return;this.force.add(force).put(this.force);this.wake()};Particle.prototype.applyImpulse=function applyImpulse(impulse){if(impulse.isZero())return;var velocity=this.velocity;velocity.add(impulse.mult(this.inverseMass)).put(velocity)};Particle.prototype.integrateVelocity=function integrateVelocity(dt){Particle.INTEGRATOR.integrateVelocity(this,dt)};Particle.prototype.integratePosition=function integratePosition(dt){Particle.INTEGRATOR.integratePosition(this,dt)};Particle.prototype._integrate=function _integrate(dt){this.integrateVelocity(dt);this.integratePosition(dt)};Particle.prototype.getEnergy=function getEnergy(){return.5*this.mass*this.velocity.normSquared()};Particle.prototype.getTransform=function getTransform(){this._engine.step();var position=this.position;var axis=this.axis;var transform=this.transform;if(axis!==undefined){if(axis&~Particle.AXES.X){position.x=0}if(axis&~Particle.AXES.Y){position.y=0}if(axis&~Particle.AXES.Z){position.z=0}}transform[12]=position.x;transform[13]=position.y;transform[14]=position.z;return transform};Particle.prototype.modify=function modify(target){var _spec=this._spec;_spec.transform=this.getTransform();_spec.target=target;return _spec};function _createEventOutput(){this._eventOutput=new EventHandler;this._eventOutput.bindThis(this);EventHandler.setOutputHandler(this,this._eventOutput)}Particle.prototype.emit=function emit(type,data){if(!this._eventOutput)return;this._eventOutput.emit(type,data)};Particle.prototype.on=function on(){_createEventOutput.call(this);return this.on.apply(this,arguments)};Particle.prototype.removeListener=function removeListener(){_createEventOutput.call(this);return this.removeListener.apply(this,arguments)};Particle.prototype.pipe=function pipe(){_createEventOutput.call(this);return this.pipe.apply(this,arguments)};Particle.prototype.unpipe=function unpipe(){_createEventOutput.call(this);return this.unpipe.apply(this,arguments)};module.exports=Particle},{"../integrators/SymplecticEuler":30,"famous/core/EventHandler":7,"famous/core/Transform":13,"famous/math/Vector":22}],25:[function(require,module,exports){var EventHandler=require("famous/core/EventHandler");function Constraint(){this.options=this.options||{};this._energy=0;this._eventOutput=null}Constraint.prototype.setOptions=function setOptions(options){for(var key in options)this.options[key]=options[key]};Constraint.prototype.applyConstraint=function applyConstraint(){};Constraint.prototype.getEnergy=function getEnergy(){return this._energy};Constraint.prototype.setEnergy=function setEnergy(energy){this._energy=energy};function _createEventOutput(){this._eventOutput=new EventHandler;this._eventOutput.bindThis(this);EventHandler.setOutputHandler(this,this._eventOutput)}Constraint.prototype.on=function on(){_createEventOutput.call(this);return this.on.apply(this,arguments)};Constraint.prototype.addListener=function addListener(){_createEventOutput.call(this);return this.addListener.apply(this,arguments)};Constraint.prototype.pipe=function pipe(){_createEventOutput.call(this);return this.pipe.apply(this,arguments)};Constraint.prototype.removeListener=function removeListener(){return this.removeListener.apply(this,arguments)};Constraint.prototype.unpipe=function unpipe(){return this.unpipe.apply(this,arguments)};module.exports=Constraint},{"famous/core/EventHandler":7}],26:[function(require,module,exports){var Constraint=require("./Constraint");var Vector=require("famous/math/Vector");function Snap(options){this.options=Object.create(this.constructor.DEFAULT_OPTIONS);if(options)this.setOptions(options);this.pDiff=new Vector;this.vDiff=new Vector;this.impulse1=new Vector;this.impulse2=new Vector;Constraint.call(this)}Snap.prototype=Object.create(Constraint.prototype);Snap.prototype.constructor=Snap;Snap.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,anchor:undefined};var pi=Math.PI;function _calcEnergy(impulse,disp,dt){return Math.abs(impulse.dot(disp)/dt)}Snap.prototype.setOptions=function setOptions(options){if(options.anchor!==undefined){if(options.anchor instanceof Vector)this.options.anchor=options.anchor;if(options.anchor.position instanceof Vector)this.options.anchor=options.anchor.position;if(options.anchor instanceof Array)this.options.anchor=new Vector(options.anchor)}if(options.length!==undefined)this.options.length=options.length;if(options.dampingRatio!==undefined)this.options.dampingRatio=options.dampingRatio;if(options.period!==undefined)this.options.period=options.period};Snap.prototype.setAnchor=function setAnchor(v){if(this.options.anchor!==undefined)this.options.anchor=new Vector;this.options.anchor.set(v)};Snap.prototype.getEnergy=function getEnergy(target,source){var options=this.options;var restLength=options.length;var anchor=options.anchor||source.position;var strength=Math.pow(2*pi/options.period,2);var dist=anchor.sub(target.position).norm()-restLength;return.5*strength*dist*dist};Snap.prototype.applyConstraint=function applyConstraint(targets,source,dt){var options=this.options;var pDiff=this.pDiff;var vDiff=this.vDiff;var impulse1=this.impulse1;var impulse2=this.impulse2;var length=options.length;var anchor=options.anchor||source.position;var period=options.period;var dampingRatio=options.dampingRatio;for(var i=0;i<targets.length;i++){var target=targets[i];var p1=target.position;var v1=target.velocity;var m1=target.mass;var w1=target.inverseMass;pDiff.set(p1.sub(anchor));var dist=pDiff.norm()-length;var effMass;if(source){var w2=source.inverseMass;var v2=source.velocity;vDiff.set(v1.sub(v2));effMass=1/(w1+w2)}else{vDiff.set(v1);effMass=m1}var gamma;var beta;if(this.options.period===0){gamma=0;beta=1}else{var k=4*effMass*pi*pi/(period*period);var c=4*effMass*pi*dampingRatio/period;beta=dt*k/(c+dt*k);gamma=1/(c+dt*k)}var antiDrift=beta/dt*dist;pDiff.normalize(-antiDrift).sub(vDiff).mult(dt/(gamma+dt/effMass)).put(impulse1);target.applyImpulse(impulse1);if(source){impulse1.mult(-1).put(impulse2);source.applyImpulse(impulse2)}this.setEnergy(_calcEnergy(impulse1,pDiff,dt))}};module.exports=Snap},{"./Constraint":25,"famous/math/Vector":22}],27:[function(require,module,exports){var Constraint=require("./Constraint");var Vector=require("famous/math/Vector");function Wall(options){this.options=Object.create(Wall.DEFAULT_OPTIONS);if(options)this.setOptions(options);this.diff=new Vector;this.impulse=new Vector;Constraint.call(this)}Wall.prototype=Object.create(Constraint.prototype);Wall.prototype.constructor=Wall;Wall.ON_CONTACT={REFLECT:0,SILENT:1};Wall.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0,normal:[1,0,0],distance:0,onContact:Wall.ON_CONTACT.REFLECT};Wall.prototype.setOptions=function setOptions(options){if(options.normal!==undefined){if(options.normal instanceof Vector)this.options.normal=options.normal.clone();if(options.normal instanceof Array)this.options.normal=new Vector(options.normal)}if(options.restitution!==undefined)this.options.restitution=options.restitution;if(options.drift!==undefined)this.options.drift=options.drift;if(options.slop!==undefined)this.options.slop=options.slop;if(options.distance!==undefined)this.options.distance=options.distance;if(options.onContact!==undefined)this.options.onContact=options.onContact};function _getNormalVelocity(n,v){return v.dot(n)}function _getDistanceFromOrigin(p){var n=this.options.normal;var d=this.options.distance;return p.dot(n)+d}function _onEnter(particle,overlap,dt){var p=particle.position;var v=particle.velocity;var m=particle.mass;var n=this.options.normal;var action=this.options.onContact;var restitution=this.options.restitution;var impulse=this.impulse;var drift=this.options.drift;var slop=-this.options.slop;var gamma=0;if(this._eventOutput){var data={particle:particle,wall:this,overlap:overlap,normal:n};this._eventOutput.emit("preCollision",data);this._eventOutput.emit("collision",data)}switch(action){case Wall.ON_CONTACT.REFLECT:var lambda=overlap<slop?-((1+restitution)*n.dot(v)+drift/dt*(overlap-slop))/(m*dt+gamma):-((1+restitution)*n.dot(v))/(m*dt+gamma);impulse.set(n.mult(dt*lambda));particle.applyImpulse(impulse);particle.setPosition(p.add(n.mult(-overlap)));break}if(this._eventOutput)this._eventOutput.emit("postCollision",data)}function _onExit(particle,overlap,dt){var action=this.options.onContact;var p=particle.position;var n=this.options.normal;if(action===Wall.ON_CONTACT.REFLECT){particle.setPosition(p.add(n.mult(-overlap)))}}Wall.prototype.applyConstraint=function applyConstraint(targets,source,dt){var n=this.options.normal;for(var i=0;i<targets.length;i++){var particle=targets[i];var p=particle.position;var v=particle.velocity;var r=particle.radius||0;var overlap=_getDistanceFromOrigin.call(this,p.add(n.mult(-r)));var nv=_getNormalVelocity.call(this,n,v);if(overlap<=0){if(nv<0)_onEnter.call(this,particle,overlap,dt);else _onExit.call(this,particle,overlap,dt)}}};module.exports=Wall},{"./Constraint":25,"famous/math/Vector":22}],28:[function(require,module,exports){var Vector=require("famous/math/Vector");var EventHandler=require("famous/core/EventHandler");function Force(force){this.force=new Vector(force);this._energy=0;this._eventOutput=null}Force.prototype.setOptions=function setOptions(options){for(var key in options)this.options[key]=options[key]};Force.prototype.applyForce=function applyForce(body){body.applyForce(this.force)};Force.prototype.getEnergy=function getEnergy(){return this._energy};Force.prototype.setEnergy=function setEnergy(energy){this._energy=energy};function _createEventOutput(){this._eventOutput=new EventHandler;this._eventOutput.bindThis(this);EventHandler.setOutputHandler(this,this._eventOutput)}Force.prototype.on=function on(){_createEventOutput.call(this);return this.on.apply(this,arguments)};Force.prototype.addListener=function addListener(){_createEventOutput.call(this);return this.addListener.apply(this,arguments)};Force.prototype.pipe=function pipe(){_createEventOutput.call(this);return this.pipe.apply(this,arguments)};Force.prototype.removeListener=function removeListener(){return this.removeListener.apply(this,arguments)};Force.prototype.unpipe=function unpipe(){return this.unpipe.apply(this,arguments)};module.exports=Force},{"famous/core/EventHandler":7,"famous/math/Vector":22}],29:[function(require,module,exports){var Force=require("./Force");var Vector=require("famous/math/Vector");function Spring(options){this.options=Object.create(this.constructor.DEFAULT_OPTIONS);if(options)this.setOptions(options);this.disp=new Vector(0,0,0);_init.call(this);Force.call(this)}Spring.prototype=Object.create(Force.prototype);Spring.prototype.constructor=Spring;var pi=Math.PI;Spring.FORCE_FUNCTIONS={FENE:function(dist,rMax){var rMaxSmall=rMax*.99;var r=Math.max(Math.min(dist,rMaxSmall),-rMaxSmall);return r/(1-r*r/(rMax*rMax))},HOOK:function(dist){return dist}};Spring.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:Infinity,anchor:undefined,forceFunction:Spring.FORCE_FUNCTIONS.HOOK};function _setForceFunction(fn){this.forceFunction=fn}function _calcStiffness(){var options=this.options;options.stiffness=Math.pow(2*pi/options.period,2)}function _calcDamping(){var options=this.options;options.damping=4*pi*options.dampingRatio/options.period}function _calcEnergy(strength,dist){return.5*strength*dist*dist}function _init(){_setForceFunction.call(this,this.options.forceFunction);_calcStiffness.call(this);_calcDamping.call(this)}Spring.prototype.setOptions=function setOptions(options){if(options.anchor!==undefined){if(options.anchor.position instanceof Vector)this.options.anchor=options.anchor.position;if(options.anchor instanceof Vector)this.options.anchor=options.anchor;if(options.anchor instanceof Array)this.options.anchor=new Vector(options.anchor)}if(options.period!==undefined)this.options.period=options.period;if(options.dampingRatio!==undefined)this.options.dampingRatio=options.dampingRatio;if(options.length!==undefined)this.options.length=options.length;if(options.forceFunction!==undefined)this.options.forceFunction=options.forceFunction;if(options.maxLength!==undefined)this.options.maxLength=options.maxLength;_init.call(this)};Spring.prototype.applyForce=function applyForce(targets,source){var force=this.force;var disp=this.disp;var options=this.options;var stiffness=options.stiffness;var damping=options.damping;var restLength=options.length;var lMax=options.maxLength;var anchor=options.anchor||source.position;for(var i=0;i<targets.length;i++){var target=targets[i];var p2=target.position;var v2=target.velocity;anchor.sub(p2).put(disp);var dist=disp.norm()-restLength;if(dist===0)return;var m=target.mass;stiffness*=m;damping*=m;disp.normalize(stiffness*this.forceFunction(dist,lMax)).put(force);if(damping)if(source)force.add(v2.sub(source.velocity).mult(-damping)).put(force);else force.add(v2.mult(-damping)).put(force);target.applyForce(force);if(source)source.applyForce(force.mult(-1));this.setEnergy(_calcEnergy(stiffness,dist))}};Spring.prototype.getEnergy=function getEnergy(target){var options=this.options;var restLength=options.length;var anchor=options.anchor;var strength=options.stiffness;var dist=anchor.sub(target.position).norm()-restLength;return.5*strength*dist*dist};Spring.prototype.setAnchor=function setAnchor(anchor){if(!this.options.anchor)this.options.anchor=new Vector;this.options.anchor.set(anchor)};module.exports=Spring},{"./Force":28,"famous/math/Vector":22}],30:[function(require,module,exports){var OptionsManager=require("famous/core/OptionsManager");function SymplecticEuler(options){this.options=Object.create(SymplecticEuler.DEFAULT_OPTIONS);this._optionsManager=new OptionsManager(this.options);if(options)this.setOptions(options)}SymplecticEuler.DEFAULT_OPTIONS={velocityCap:undefined,angularVelocityCap:undefined};SymplecticEuler.prototype.setOptions=function setOptions(options){this._optionsManager.patch(options)};SymplecticEuler.prototype.getOptions=function getOptions(){return this._optionsManager.value()};SymplecticEuler.prototype.integrateVelocity=function integrateVelocity(body,dt){var v=body.velocity;var w=body.inverseMass;var f=body.force;if(f.isZero())return;v.add(f.mult(dt*w)).put(v);f.clear()};SymplecticEuler.prototype.integratePosition=function integratePosition(body,dt){var p=body.position;var v=body.velocity;if(this.options.velocityCap)v.cap(this.options.velocityCap).put(v);p.add(v.mult(dt)).put(p)};SymplecticEuler.prototype.integrateAngularMomentum=function integrateAngularMomentum(body,dt){var L=body.angularMomentum;var t=body.torque;if(t.isZero())return;if(this.options.angularVelocityCap)t.cap(this.options.angularVelocityCap).put(t);L.add(t.mult(dt)).put(L);t.clear()};SymplecticEuler.prototype.integrateOrientation=function integrateOrientation(body,dt){var q=body.orientation;var w=body.angularVelocity;if(w.isZero())return;q.add(q.multiply(w).scalarMultiply(.5*dt)).put(q)};module.exports=SymplecticEuler},{"famous/core/OptionsManager":9}],31:[function(require,module,exports){var Surface=require("famous/core/Surface");var Context=require("famous/core/Context");function ContainerSurface(options){Surface.call(this,options);this._container=document.createElement("div");this._container.classList.add("famous-group");this._container.classList.add("famous-container-group");this._shouldRecalculateSize=false;this.context=new Context(this._container);this.setContent(this._container)}ContainerSurface.prototype=Object.create(Surface.prototype);ContainerSurface.prototype.constructor=ContainerSurface;ContainerSurface.prototype.elementType="div";ContainerSurface.prototype.elementClass="famous-surface";ContainerSurface.prototype.add=function add(){return this.context.add.apply(this.context,arguments)};ContainerSurface.prototype.render=function render(){if(this._sizeDirty)this._shouldRecalculateSize=true;return Surface.prototype.render.apply(this,arguments)};ContainerSurface.prototype.deploy=function deploy(){this._shouldRecalculateSize=true;return Surface.prototype.deploy.apply(this,arguments)};ContainerSurface.prototype.commit=function commit(context,transform,opacity,origin,size){var previousSize=this._size?[this._size[0],this._size[1]]:null;var result=Surface.prototype.commit.apply(this,arguments);if(this._shouldRecalculateSize||previousSize&&(this._size[0]!==previousSize[0]||this._size[1]!==previousSize[1])){this.context.setSize();this._shouldRecalculateSize=false}this.context.update();return result};module.exports=ContainerSurface},{"famous/core/Context":1,"famous/core/Surface":12}],32:[function(require,module,exports){var Surface=require("famous/core/Surface");function ImageSurface(options){this._imageUrl=undefined;Surface.apply(this,arguments)}var urlCache=[];var countCache=[];var nodeCache=[];var cacheEnabled=true;ImageSurface.enableCache=function enableCache(){cacheEnabled=true};ImageSurface.disableCache=function disableCache(){cacheEnabled=false};ImageSurface.clearCache=function clearCache(){urlCache=[];countCache=[];nodeCache=[]};ImageSurface.getCache=function getCache(){return{urlCache:urlCache,countCache:countCache,nodeCache:countCache}};ImageSurface.prototype=Object.create(Surface.prototype);ImageSurface.prototype.constructor=ImageSurface;
ImageSurface.prototype.elementType="img";ImageSurface.prototype.elementClass="famous-surface";ImageSurface.prototype.setContent=function setContent(imageUrl){var urlIndex=urlCache.indexOf(this._imageUrl);if(urlIndex!==-1){if(countCache[urlIndex]===1){urlCache.splice(urlIndex,1);countCache.splice(urlIndex,1);nodeCache.splice(urlIndex,1)}else{countCache[urlIndex]--}}urlIndex=urlCache.indexOf(imageUrl);if(urlIndex===-1){urlCache.push(imageUrl);countCache.push(1)}else{countCache[urlIndex]++}this._imageUrl=imageUrl;this._contentDirty=true};ImageSurface.prototype.deploy=function deploy(target){var urlIndex=urlCache.indexOf(this._imageUrl);if(nodeCache[urlIndex]===undefined&&cacheEnabled){var img=new Image;img.src=this._imageUrl||"";nodeCache[urlIndex]=img}target.src=this._imageUrl||""};ImageSurface.prototype.recall=function recall(target){target.src=""};module.exports=ImageSurface},{"famous/core/Surface":12}],33:[function(require,module,exports){var Easing={inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){if((t/=.5)<1)return.5*t*t;return-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){if((t/=.5)<1)return.5*t*t*t;return.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){if((t/=.5)<1)return.5*t*t*t*t;return-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){if((t/=.5)<1)return.5*t*t*t*t*t;return.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return t===0?0:Math.pow(2,10*(t-1))},outExpo:function(t){return t===1?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){if(t===0)return 0;if(t===1)return 1;if((t/=.5)<1)return.5*Math.pow(2,10*(t-1));return.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){if((t/=.5)<1)return-.5*(Math.sqrt(1-t*t)-1);return.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0)return 0;if(t===1)return 1;if(!p)p=.3;s=p/(2*Math.PI)*Math.asin(1/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p))},outElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0)return 0;if(t===1)return 1;if(!p)p=.3;s=p/(2*Math.PI)*Math.asin(1/a);return a*Math.pow(2,-10*t)*Math.sin((t-s)*(2*Math.PI)/p)+1},inOutElastic:function(t){var s=1.70158;var p=0;var a=1;if(t===0)return 0;if((t/=.5)===2)return 1;if(!p)p=.3*1.5;s=p/(2*Math.PI)*Math.asin(1/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p));return a*Math.pow(2,-10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/p)*.5+1},inBack:function(t,s){if(s===undefined)s=1.70158;return t*t*((s+1)*t-s)},outBack:function(t,s){if(s===undefined)s=1.70158;return--t*t*((s+1)*t+s)+1},inOutBack:function(t,s){if(s===undefined)s=1.70158;if((t/=.5)<1)return.5*(t*t*(((s*=1.525)+1)*t-s));return.5*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)},inBounce:function(t){return 1-Easing.outBounce(1-t)},outBounce:function(t){if(t<1/2.75){return 7.5625*t*t}else if(t<2/2.75){return 7.5625*(t-=1.5/2.75)*t+.75}else if(t<2.5/2.75){return 7.5625*(t-=2.25/2.75)*t+.9375}else{return 7.5625*(t-=2.625/2.75)*t+.984375}},inOutBounce:function(t){if(t<.5)return Easing.inBounce(t*2)*.5;return Easing.outBounce(t*2-1)*.5+.5}};module.exports=Easing},{}],34:[function(require,module,exports){var Utility=require("famous/utilities/Utility");function MultipleTransition(method){this.method=method;this._instances=[];this.state=[]}MultipleTransition.SUPPORTS_MULTIPLE=true;MultipleTransition.prototype.get=function get(){for(var i=0;i<this._instances.length;i++){this.state[i]=this._instances[i].get()}return this.state};MultipleTransition.prototype.set=function set(endState,transition,callback){var _allCallback=Utility.after(endState.length,callback);for(var i=0;i<endState.length;i++){if(!this._instances[i])this._instances[i]=new this.method;this._instances[i].set(endState[i],transition,_allCallback)}};MultipleTransition.prototype.reset=function reset(startState){for(var i=0;i<startState.length;i++){if(!this._instances[i])this._instances[i]=new this.method;this._instances[i].reset(startState[i])}};module.exports=MultipleTransition},{"famous/utilities/Utility":42}],35:[function(require,module,exports){var PE=require("famous/physics/PhysicsEngine");var Particle=require("famous/physics/bodies/Particle");var Spring=require("famous/physics/constraints/Snap");var Vector=require("famous/math/Vector");function SnapTransition(state){state=state||0;this.endState=new Vector(state);this.initState=new Vector;this._dimensions=1;this._restTolerance=1e-10;this._absRestTolerance=this._restTolerance;this._callback=undefined;this.PE=new PE;this.particle=new Particle;this.spring=new Spring({anchor:this.endState});this.PE.addBody(this.particle);this.PE.attach(this.spring,this.particle)}SnapTransition.SUPPORTS_MULTIPLE=3;SnapTransition.DEFAULT_OPTIONS={period:100,dampingRatio:.2,velocity:0};function _getEnergy(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function _setAbsoluteRestTolerance(){var distance=this.endState.sub(this.initState).normSquared();this._absRestTolerance=distance===0?this._restTolerance:this._restTolerance*distance}function _setTarget(target){this.endState.set(target);_setAbsoluteRestTolerance.call(this)}function _wake(){this.PE.wake()}function _sleep(){this.PE.sleep()}function _setParticlePosition(p){this.particle.position.set(p)}function _setParticleVelocity(v){this.particle.velocity.set(v)}function _getParticlePosition(){return this._dimensions===0?this.particle.getPosition1D():this.particle.getPosition()}function _getParticleVelocity(){return this._dimensions===0?this.particle.getVelocity1D():this.particle.getVelocity()}function _setCallback(callback){this._callback=callback}function _setupDefinition(definition){var defaults=SnapTransition.DEFAULT_OPTIONS;if(definition.period===undefined)definition.period=defaults.period;if(definition.dampingRatio===undefined)definition.dampingRatio=defaults.dampingRatio;if(definition.velocity===undefined)definition.velocity=defaults.velocity;this.spring.setOptions({period:definition.period,dampingRatio:definition.dampingRatio});_setParticleVelocity.call(this,definition.velocity)}function _update(){if(this.PE.isSleeping()){if(this._callback){var cb=this._callback;this._callback=undefined;cb()}return}if(_getEnergy.call(this)<this._absRestTolerance){_setParticlePosition.call(this,this.endState);_setParticleVelocity.call(this,[0,0,0]);_sleep.call(this)}}SnapTransition.prototype.reset=function reset(state,velocity){this._dimensions=state instanceof Array?state.length:0;this.initState.set(state);_setParticlePosition.call(this,state);_setTarget.call(this,state);if(velocity)_setParticleVelocity.call(this,velocity);_setCallback.call(this,undefined)};SnapTransition.prototype.getVelocity=function getVelocity(){return _getParticleVelocity.call(this)};SnapTransition.prototype.setVelocity=function setVelocity(velocity){this.call(this,_setParticleVelocity(velocity))};SnapTransition.prototype.isActive=function isActive(){return!this.PE.isSleeping()};SnapTransition.prototype.halt=function halt(){this.set(this.get())};SnapTransition.prototype.get=function get(){_update.call(this);return _getParticlePosition.call(this)};SnapTransition.prototype.set=function set(state,definition,callback){if(!definition){this.reset(state);if(callback)callback();return}this._dimensions=state instanceof Array?state.length:0;_wake.call(this);_setupDefinition.call(this,definition);_setTarget.call(this,state);_setCallback.call(this,callback)};module.exports=SnapTransition},{"famous/math/Vector":22,"famous/physics/PhysicsEngine":23,"famous/physics/bodies/Particle":24,"famous/physics/constraints/Snap":26}],36:[function(require,module,exports){var PE=require("famous/physics/PhysicsEngine");var Particle=require("famous/physics/bodies/Particle");var Spring=require("famous/physics/forces/Spring");var Vector=require("famous/math/Vector");function SpringTransition(state){state=state||0;this.endState=new Vector(state);this.initState=new Vector;this._dimensions=undefined;this._restTolerance=1e-10;this._absRestTolerance=this._restTolerance;this._callback=undefined;this.PE=new PE;this.spring=new Spring({anchor:this.endState});this.particle=new Particle;this.PE.addBody(this.particle);this.PE.attach(this.spring,this.particle)}SpringTransition.SUPPORTS_MULTIPLE=3;SpringTransition.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0};function _getEnergy(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function _setParticlePosition(p){this.particle.setPosition(p)}function _setParticleVelocity(v){this.particle.setVelocity(v)}function _getParticlePosition(){return this._dimensions===0?this.particle.getPosition1D():this.particle.getPosition()}function _getParticleVelocity(){return this._dimensions===0?this.particle.getVelocity1D():this.particle.getVelocity()}function _setCallback(callback){this._callback=callback}function _wake(){this.PE.wake()}function _sleep(){this.PE.sleep()}function _update(){if(this.PE.isSleeping()){if(this._callback){var cb=this._callback;this._callback=undefined;cb()}return}if(_getEnergy.call(this)<this._absRestTolerance){_setParticlePosition.call(this,this.endState);_setParticleVelocity.call(this,[0,0,0]);_sleep.call(this)}}function _setupDefinition(definition){var defaults=SpringTransition.DEFAULT_OPTIONS;if(definition.period===undefined)definition.period=defaults.period;if(definition.dampingRatio===undefined)definition.dampingRatio=defaults.dampingRatio;if(definition.velocity===undefined)definition.velocity=defaults.velocity;if(definition.period<150){definition.period=150;console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")}this.spring.setOptions({period:definition.period,dampingRatio:definition.dampingRatio});_setParticleVelocity.call(this,definition.velocity)}function _setAbsoluteRestTolerance(){var distance=this.endState.sub(this.initState).normSquared();this._absRestTolerance=distance===0?this._restTolerance:this._restTolerance*distance}function _setTarget(target){this.endState.set(target);_setAbsoluteRestTolerance.call(this)}SpringTransition.prototype.reset=function reset(pos,vel){this._dimensions=pos instanceof Array?pos.length:0;this.initState.set(pos);_setParticlePosition.call(this,pos);_setTarget.call(this,pos);if(vel)_setParticleVelocity.call(this,vel);_setCallback.call(this,undefined)};SpringTransition.prototype.getVelocity=function getVelocity(){return _getParticleVelocity.call(this)};SpringTransition.prototype.setVelocity=function setVelocity(v){this.call(this,_setParticleVelocity(v))};SpringTransition.prototype.isActive=function isActive(){return!this.PE.isSleeping()};SpringTransition.prototype.halt=function halt(){this.set(this.get())};SpringTransition.prototype.get=function get(){_update.call(this);return _getParticlePosition.call(this)};SpringTransition.prototype.set=function set(endState,definition,callback){if(!definition){this.reset(endState);if(callback)callback();return}this._dimensions=endState instanceof Array?endState.length:0;_wake.call(this);_setupDefinition.call(this,definition);_setTarget.call(this,endState);_setCallback.call(this,callback)};module.exports=SpringTransition},{"famous/math/Vector":22,"famous/physics/PhysicsEngine":23,"famous/physics/bodies/Particle":24,"famous/physics/forces/Spring":29}],37:[function(require,module,exports){var MultipleTransition=require("./MultipleTransition");var TweenTransition=require("./TweenTransition");function Transitionable(start){this.currentAction=null;this.actionQueue=[];this.callbackQueue=[];this.state=0;this.velocity=undefined;this._callback=undefined;this._engineInstance=null;this._currentMethod=null;this.set(start)}var transitionMethods={};Transitionable.registerMethod=function registerMethod(name,engineClass){if(!(name in transitionMethods)){transitionMethods[name]=engineClass;return true}else return false};Transitionable.unregisterMethod=function unregisterMethod(name){if(name in transitionMethods){delete transitionMethods[name];return true}else return false};function _loadNext(){if(this._callback){var callback=this._callback;this._callback=undefined;callback()}if(this.actionQueue.length<=0){this.set(this.get());return}this.currentAction=this.actionQueue.shift();this._callback=this.callbackQueue.shift();var method=null;var endValue=this.currentAction[0];var transition=this.currentAction[1];if(transition instanceof Object&&transition.method){method=transition.method;if(typeof method==="string")method=transitionMethods[method]}else{method=TweenTransition}if(this._currentMethod!==method){if(!(endValue instanceof Object)||method.SUPPORTS_MULTIPLE===true||endValue.length<=method.SUPPORTS_MULTIPLE){this._engineInstance=new method}else{this._engineInstance=new MultipleTransition(method)}this._currentMethod=method}this._engineInstance.reset(this.state,this.velocity);if(this.velocity!==undefined)transition.velocity=this.velocity;this._engineInstance.set(endValue,transition,_loadNext.bind(this))}Transitionable.prototype.set=function set(endState,transition,callback){if(!transition){this.reset(endState);if(callback)callback();return this}var action=[endState,transition];this.actionQueue.push(action);this.callbackQueue.push(callback);if(!this.currentAction)_loadNext.call(this);return this};Transitionable.prototype.reset=function reset(startState,startVelocity){this._currentMethod=null;this._engineInstance=null;this._callback=undefined;this.state=startState;this.velocity=startVelocity;this.currentAction=null;this.actionQueue=[];this.callbackQueue=[]};Transitionable.prototype.delay=function delay(duration,callback){this.set(this.get(),{duration:duration,curve:function(){return 0}},callback)};Transitionable.prototype.get=function get(timestamp){if(this._engineInstance){if(this._engineInstance.getVelocity)this.velocity=this._engineInstance.getVelocity();this.state=this._engineInstance.get(timestamp)}return this.state};Transitionable.prototype.isActive=function isActive(){return!!this.currentAction};Transitionable.prototype.halt=function halt(){return this.set(this.get())};module.exports=Transitionable},{"./MultipleTransition":34,"./TweenTransition":39}],38:[function(require,module,exports){var Transitionable=require("./Transitionable");var Transform=require("famous/core/Transform");var Utility=require("famous/utilities/Utility");function TransitionableTransform(transform){this._final=Transform.identity.slice();this._finalTranslate=[0,0,0];this._finalRotate=[0,0,0];this._finalSkew=[0,0,0];this._finalScale=[1,1,1];this.translate=new Transitionable(this._finalTranslate);this.rotate=new Transitionable(this._finalRotate);this.skew=new Transitionable(this._finalSkew);this.scale=new Transitionable(this._finalScale);if(transform)this.set(transform)}function _build(){return Transform.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function _buildFinal(){return Transform.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}TransitionableTransform.prototype.setTranslate=function setTranslate(translate,transition,callback){this._finalTranslate=translate;this._final=_buildFinal.call(this);this.translate.set(translate,transition,callback);return this};TransitionableTransform.prototype.setScale=function setScale(scale,transition,callback){this._finalScale=scale;this._final=_buildFinal.call(this);this.scale.set(scale,transition,callback);return this};TransitionableTransform.prototype.setRotate=function setRotate(eulerAngles,transition,callback){this._finalRotate=eulerAngles;this._final=_buildFinal.call(this);this.rotate.set(eulerAngles,transition,callback);return this};TransitionableTransform.prototype.setSkew=function setSkew(skewAngles,transition,callback){this._finalSkew=skewAngles;this._final=_buildFinal.call(this);this.skew.set(skewAngles,transition,callback);return this};TransitionableTransform.prototype.set=function set(transform,transition,callback){var components=Transform.interpret(transform);this._finalTranslate=components.translate;this._finalRotate=components.rotate;this._finalSkew=components.skew;this._finalScale=components.scale;this._final=transform;var _callback=callback?Utility.after(4,callback):null;this.translate.set(components.translate,transition,_callback);this.rotate.set(components.rotate,transition,_callback);this.skew.set(components.skew,transition,_callback);this.scale.set(components.scale,transition,_callback);return this};TransitionableTransform.prototype.setDefaultTransition=function setDefaultTransition(transition){this.translate.setDefault(transition);this.rotate.setDefault(transition);this.skew.setDefault(transition);this.scale.setDefault(transition)};TransitionableTransform.prototype.get=function get(){if(this.isActive()){return _build.call(this)}else return this._final};TransitionableTransform.prototype.getFinal=function getFinal(){return this._final};TransitionableTransform.prototype.isActive=function isActive(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()};TransitionableTransform.prototype.halt=function halt(){this._final=this.get();this.translate.halt();this.rotate.halt();this.skew.halt();this.scale.halt()};module.exports=TransitionableTransform},{"./Transitionable":37,"famous/core/Transform":13,"famous/utilities/Utility":42}],39:[function(require,module,exports){function TweenTransition(options){this.options=Object.create(TweenTransition.DEFAULT_OPTIONS);if(options)this.setOptions(options);this._startTime=0;this._startValue=0;this._updateTime=0;this._endValue=0;this._curve=undefined;this._duration=0;this._active=false;this._callback=undefined;this.state=0;this.velocity=undefined}TweenTransition.Curves={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){if(t<=.5)return 2*t*t;else return-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}};TweenTransition.SUPPORTS_MULTIPLE=true;TweenTransition.DEFAULT_OPTIONS={curve:TweenTransition.Curves.linear,duration:500,speed:0};var registeredCurves={};TweenTransition.registerCurve=function registerCurve(curveName,curve){if(!registeredCurves[curveName]){registeredCurves[curveName]=curve;return true}else{return false}};TweenTransition.unregisterCurve=function unregisterCurve(curveName){if(registeredCurves[curveName]){delete registeredCurves[curveName];return true}else{return false}};TweenTransition.getCurve=function getCurve(curveName){var curve=registeredCurves[curveName];if(curve!==undefined)return curve;else throw new Error("curve not registered")};TweenTransition.getCurves=function getCurves(){return registeredCurves};function _interpolate(a,b,t){return(1-t)*a+t*b}function _clone(obj){if(obj instanceof Object){if(obj instanceof Array)return obj.slice(0);else return Object.create(obj)}else return obj}function _normalize(transition,defaultTransition){var result={curve:defaultTransition.curve};if(defaultTransition.duration)result.duration=defaultTransition.duration;if(defaultTransition.speed)result.speed=defaultTransition.speed;if(transition instanceof Object){if(transition.duration!==undefined)result.duration=transition.duration;if(transition.curve)result.curve=transition.curve;if(transition.speed)result.speed=transition.speed}if(typeof result.curve==="string")result.curve=TweenTransition.getCurve(result.curve);return result}TweenTransition.prototype.setOptions=function setOptions(options){if(options.curve!==undefined)this.options.curve=options.curve;if(options.duration!==undefined)this.options.duration=options.duration;if(options.speed!==undefined)this.options.speed=options.speed};TweenTransition.prototype.set=function set(endValue,transition,callback){if(!transition){this.reset(endValue);if(callback)callback();return}this._startValue=_clone(this.get());transition=_normalize(transition,this.options);if(transition.speed){var startValue=this._startValue;if(startValue instanceof Object){var variance=0;for(var i in startValue)variance+=(endValue[i]-startValue[i])*(endValue[i]-startValue[i]);transition.duration=Math.sqrt(variance)/transition.speed}else{transition.duration=Math.abs(endValue-startValue)/transition.speed}}this._startTime=Date.now();this._endValue=_clone(endValue);this._startVelocity=_clone(transition.velocity);this._duration=transition.duration;this._curve=transition.curve;this._active=true;this._callback=callback};TweenTransition.prototype.reset=function reset(startValue,startVelocity){if(this._callback){var callback=this._callback;this._callback=undefined;callback()}this.state=_clone(startValue);this.velocity=_clone(startVelocity);this._startTime=0;this._duration=0;this._updateTime=0;this._startValue=this.state;this._startVelocity=this.velocity;this._endValue=this.state;this._active=false};TweenTransition.prototype.getVelocity=function getVelocity(){return this.velocity};TweenTransition.prototype.get=function get(timestamp){this.update(timestamp);return this.state};function _calculateVelocity(current,start,curve,duration,t){var velocity;var eps=1e-7;var speed=(curve(t)-curve(t-eps))/eps;if(current instanceof Array){velocity=[];for(var i=0;i<current.length;i++){if(typeof current[i]==="number")velocity[i]=speed*(current[i]-start[i])/duration;else velocity[i]=0}}else velocity=speed*(current-start)/duration;return velocity}function _calculateState(start,end,t){var state;if(start instanceof Array){state=[];for(var i=0;i<start.length;i++){if(typeof start[i]==="number")state[i]=_interpolate(start[i],end[i],t);else state[i]=start[i]}}else state=_interpolate(start,end,t);return state}TweenTransition.prototype.update=function update(timestamp){if(!this._active){if(this._callback){var callback=this._callback;this._callback=undefined;callback()}return}if(!timestamp)timestamp=Date.now();if(this._updateTime>=timestamp)return;this._updateTime=timestamp;var timeSinceStart=timestamp-this._startTime;if(timeSinceStart>=this._duration){this.state=this._endValue;this.velocity=_calculateVelocity(this.state,this._startValue,this._curve,this._duration,1);this._active=false}else if(timeSinceStart<0){this.state=this._startValue;this.velocity=this._startVelocity}else{var t=timeSinceStart/this._duration;this.state=_calculateState(this._startValue,this._endValue,this._curve(t));this.velocity=_calculateVelocity(this.state,this._startValue,this._curve,this._duration,t)}};TweenTransition.prototype.isActive=function isActive(){return this._active};TweenTransition.prototype.halt=function halt(){this.reset(this.get())};TweenTransition.registerCurve("linear",TweenTransition.Curves.linear);TweenTransition.registerCurve("easeIn",TweenTransition.Curves.easeIn);TweenTransition.registerCurve("easeOut",TweenTransition.Curves.easeOut);TweenTransition.registerCurve("easeInOut",TweenTransition.Curves.easeInOut);TweenTransition.registerCurve("easeOutBounce",TweenTransition.Curves.easeOutBounce);TweenTransition.registerCurve("spring",TweenTransition.Curves.spring);TweenTransition.customCurve=function customCurve(v1,v2){v1=v1||0;v2=v2||0;return function(t){return v1*t+(-2*v1-v2+3)*t*t+(v1+v2-2)*t*t*t}};module.exports=TweenTransition},{}],40:[function(require,module,exports){var PE=require("famous/physics/PhysicsEngine");var Particle=require("famous/physics/bodies/Particle");var Spring=require("famous/physics/forces/Spring");var Wall=require("famous/physics/constraints/Wall");var Vector=require("famous/math/Vector");function WallTransition(state){state=state||0;this.endState=new Vector(state);this.initState=new Vector;this.spring=new Spring({anchor:this.endState});this.wall=new Wall;this._restTolerance=1e-10;this._dimensions=1;this._absRestTolerance=this._restTolerance;this._callback=undefined;this.PE=new PE;this.particle=new Particle;this.PE.addBody(this.particle);this.PE.attach([this.wall,this.spring],this.particle)}WallTransition.SUPPORTS_MULTIPLE=3;WallTransition.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0,restitution:.5};function _getEnergy(){return this.particle.getEnergy()+this.spring.getEnergy(this.particle)}function _setAbsoluteRestTolerance(){var distance=this.endState.sub(this.initState).normSquared();this._absRestTolerance=distance===0?this._restTolerance:this._restTolerance*distance}function _wake(){this.PE.wake()}function _sleep(){this.PE.sleep()}function _setTarget(target){this.endState.set(target);var dist=this.endState.sub(this.initState).norm();this.wall.setOptions({distance:this.endState.norm(),normal:dist===0?this.particle.velocity.normalize(-1):this.endState.sub(this.initState).normalize(-1)});_setAbsoluteRestTolerance.call(this)}function _setParticlePosition(p){this.particle.position.set(p)}function _setParticleVelocity(v){this.particle.velocity.set(v)}function _getParticlePosition(){return this._dimensions===0?this.particle.getPosition1D():this.particle.getPosition()}function _getParticleVelocity(){return this._dimensions===0?this.particle.getVelocity1D():this.particle.getVelocity()}function _setCallback(callback){this._callback=callback}function _update(){if(this.PE.isSleeping()){if(this._callback){var cb=this._callback;this._callback=undefined;cb()}return}var energy=_getEnergy.call(this);if(energy<this._absRestTolerance){_sleep.call(this);_setParticlePosition.call(this,this.endState);_setParticleVelocity.call(this,[0,0,0])}}function _setupDefinition(def){var defaults=WallTransition.DEFAULT_OPTIONS;if(def.period===undefined)def.period=defaults.period;if(def.dampingRatio===undefined)def.dampingRatio=defaults.dampingRatio;if(def.velocity===undefined)def.velocity=defaults.velocity;if(def.restitution===undefined)def.restitution=defaults.restitution;this.spring.setOptions({period:def.period,dampingRatio:def.dampingRatio});this.wall.setOptions({restitution:def.restitution});_setParticleVelocity.call(this,def.velocity)}WallTransition.prototype.reset=function reset(state,velocity){this._dimensions=state instanceof Array?state.length:0;this.initState.set(state);_setParticlePosition.call(this,state);if(velocity)_setParticleVelocity.call(this,velocity);_setTarget.call(this,state);_setCallback.call(this,undefined)};WallTransition.prototype.getVelocity=function getVelocity(){return _getParticleVelocity.call(this)};WallTransition.prototype.setVelocity=function setVelocity(velocity){this.call(this,_setParticleVelocity(velocity))};WallTransition.prototype.isActive=function isActive(){return!this.PE.isSleeping()};WallTransition.prototype.halt=function halt(){this.set(this.get())};WallTransition.prototype.get=function get(){_update.call(this);return _getParticlePosition.call(this)};WallTransition.prototype.set=function set(state,definition,callback){if(!definition){this.reset(state);if(callback)callback();return}this._dimensions=state instanceof Array?state.length:0;_wake.call(this);_setupDefinition.call(this,definition);_setTarget.call(this,state);_setCallback.call(this,callback)};module.exports=WallTransition},{"famous/math/Vector":22,"famous/physics/PhysicsEngine":23,"famous/physics/bodies/Particle":24,"famous/physics/constraints/Wall":27,"famous/physics/forces/Spring":29}],41:[function(require,module,exports){var FamousEngine=require("famous/core/Engine");var _event="prerender";var getTime=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};function addTimerFunction(fn){FamousEngine.on(_event,fn);return fn}function setTimeout(fn,duration){var t=getTime();var callback=function(){var t2=getTime();if(t2-t>=duration){fn.apply(this,arguments);FamousEngine.removeListener(_event,callback)}};return addTimerFunction(callback)}function setInterval(fn,duration){var t=getTime();var callback=function(){var t2=getTime();if(t2-t>=duration){fn.apply(this,arguments);t=getTime()}};return addTimerFunction(callback)}function after(fn,numTicks){if(numTicks===undefined)return undefined;var callback=function(){numTicks--;if(numTicks<=0){fn.apply(this,arguments);clear(callback)}};return addTimerFunction(callback)}function every(fn,numTicks){numTicks=numTicks||1;var initial=numTicks;var callback=function(){numTicks--;if(numTicks<=0){fn.apply(this,arguments);numTicks=initial}};return addTimerFunction(callback)}function clear(fn){FamousEngine.removeListener(_event,fn)}function debounce(func,wait){var timeout;var ctx;var timestamp;var result;var args;return function(){ctx=this;args=arguments;timestamp=getTime();var fn=function(){var last=getTime-timestamp;if(last<wait){timeout=setTimeout(fn,wait-last)}else{timeout=null;result=func.apply(ctx,args)}};clear(timeout);timeout=setTimeout(fn,wait);return result}}module.exports={setTimeout:setTimeout,setInterval:setInterval,debounce:debounce,after:after,every:every,clear:clear}},{"famous/core/Engine":4}],42:[function(require,module,exports){var Utility={};Utility.Direction={X:0,Y:1,Z:2};Utility.after=function after(count,callback){var counter=count;return function(){counter--;if(counter===0)callback.apply(this,arguments)}};Utility.loadURL=function loadURL(url,callback){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function onreadystatechange(){if(this.readyState===4){if(callback)callback(this.responseText)}};xhr.open("GET",url);xhr.send()};Utility.createDocumentFragmentFromHTML=function createDocumentFragmentFromHTML(html){var element=document.createElement("div");element.innerHTML=html;var result=document.createDocumentFragment();while(element.hasChildNodes())result.appendChild(element.firstChild);return result};Utility.clone=function clone(b){var a;if(typeof b==="object"){a={};for(var key in b){if(typeof b[key]==="object"&&b[key]!==null){if(b[key]instanceof Array){a[key]=new Array(b[key].length);for(var i=0;i<b[key].length;i++){a[key][i]=Utility.clone(b[key][i])}}else{a[key]=Utility.clone(b[key])}}else{a[key]=b[key]}}}else{a=b}return a};module.exports=Utility},{}],43:[function(require,module,exports){var OptionsManager=require("famous/core/OptionsManager");var Transform=require("famous/core/Transform");var ViewSequence=require("famous/core/ViewSequence");var Utility=require("famous/utilities/Utility");function SequentialLayout(options){this._items=null;this._size=null;this._outputFunction=SequentialLayout.DEFAULT_OUTPUT_FUNCTION;this.options=Object.create(this.constructor.DEFAULT_OPTIONS);this.optionsManager=new OptionsManager(this.options);this._itemsCache=[];this._outputCache={size:null,target:this._itemsCache};if(options)this.setOptions(options)}SequentialLayout.DEFAULT_OPTIONS={direction:Utility.Direction.Y,itemSpacing:0,defaultItemSize:[50,50]};SequentialLayout.DEFAULT_OUTPUT_FUNCTION=function DEFAULT_OUTPUT_FUNCTION(input,offset,index){var transform=this.options.direction===Utility.Direction.X?Transform.translate(offset,0):Transform.translate(0,offset);return{transform:transform,target:input.render()}};SequentialLayout.prototype.getSize=function getSize(){if(!this._size)this.render();return this._size};SequentialLayout.prototype.sequenceFrom=function sequenceFrom(items){if(items instanceof Array)items=new ViewSequence(items);this._items=items;return this};SequentialLayout.prototype.setOptions=function setOptions(options){this.optionsManager.setOptions.apply(this.optionsManager,arguments);return this};SequentialLayout.prototype.setOutputFunction=function setOutputFunction(outputFunction){this._outputFunction=outputFunction;return this};SequentialLayout.prototype.render=function render(){var length=0;var girth=0;var lengthDim=this.options.direction===Utility.Direction.X?0:1;var girthDim=this.options.direction===Utility.Direction.X?1:0;var currentNode=this._items;
var result=this._itemsCache;var i=0;while(currentNode){var item=currentNode.get();if(!item)break;var itemSize;if(item&&item.getSize)itemSize=item.getSize();if(!itemSize)itemSize=this.options.defaultItemSize;if(itemSize[girthDim]!==true)girth=Math.max(girth,itemSize[girthDim]);var output=this._outputFunction.call(this,item,length,i);result[i]=output;if(itemSize[lengthDim]&&itemSize[lengthDim]!==true)length+=itemSize[lengthDim]+this.options.itemSpacing;currentNode=currentNode.getNext();i++}this._itemsCache.splice(i);if(!girth)girth=undefined;if(!this._size)this._size=[0,0];this._size[lengthDim]=length-this.options.itemSpacing;this._size[girthDim]=girth;this._outputCache.size=this.getSize();return this._outputCache};module.exports=SequentialLayout},{"famous/core/OptionsManager":9,"famous/core/Transform":13,"famous/core/ViewSequence":15,"famous/utilities/Utility":42}],44:[function(require,module,exports){function Carousel(t,e){SizeAwareView.apply(this,arguments),this._isPlugin=e,this._data={index:void 0,paginatedIndex:1,itemsPerPage:1,items:void 0,renderables:[],length:void 0},this.sync=new GenericSync,this.layoutDefinition,this.layoutController=new LayoutController({classes:["famous-carousel-container"],itemsPerPage:this._data.itemsPerPage,loop:this.options.loop,sync:this.sync}),this.layoutController._connectContainer(this),this.clickLength=null,this._init()}var RenderNode=require("famous/core/RenderNode"),Modifier=require("famous/core/Modifier"),Engine=require("famous/core/Engine"),Surface=require("famous/core/Surface"),SizeAwareView=require("./constructors/SizeAwareView"),Timer=require("famous/utilities/Timer"),FastClick=require("famous/inputs/FastClick"),RegisterEasing=require("./registries/Easing"),RegisterPhysics=require("./registries/Physics"),GenericSync=require("famous/inputs/GenericSync"),TouchSync=require("famous/inputs/TouchSync"),MouseSync=require("famous/inputs/MouseSync"),ScrollSync=require("famous/inputs/ScrollSync"),Slide=require("./slides/Slide"),Arrows=require("./components/Arrows"),Dots=require("./components/Dots"),LayoutController=require("./layouts/LayoutController"),LayoutFactory=require("./layouts/LayoutFactory");GenericSync.register({mouse:MouseSync,touch:TouchSync,scroll:ScrollSync}),Carousel.prototype=Object.create(SizeAwareView.prototype),Carousel.prototype.constructor=Carousel,Carousel.EVENTS={selection:"selectionChange",itemClick:"itemClick"},Carousel._handleKeyup=function(t){37==t.keyCode?(this.previous(),this._eventOutput.emit(Carousel.EVENTS.selection,this._data.index)):39==t.keyCode&&(this.next(),this._eventOutput.emit(Carousel.EVENTS.selection,this._data.index))},Carousel.prototype.setContentLayout=function(t){if(!t)throw"No layout definition given!";return this.layoutDefinition=t,this.layoutController.setLayout(this.layoutDefinition),this},Carousel.prototype.getContentLayout=function(){return this.layoutDefinition},Carousel.prototype.getSelectedIndex=function(){return this._data.index},Carousel.prototype.setSelectedIndex=function(t,e){return t==this._data.index?this._data.index:(this._data.index=this._clamp(t),this._data.paginatedIndex=this._clamp(Math.floor(this._data.index/this._data.itemsPerPage)),e=void 0===e?!0:e,this.layoutController.setIndex(this._data.index,e),this.dots&&this.dots.setIndex(this._data.paginatedIndex),this._data.index)},Carousel.prototype.next=function(){var t=this._data.index+this._data.itemsPerPage;return this.setSelectedIndex(t)},Carousel.prototype.previous=function(){var t=this._data.index-this._data.itemsPerPage;return this.setSelectedIndex(t)},Carousel.prototype.getItems=function(){return this._data.items},Carousel.prototype.setItems=function(t){return this._data.items=t.slice(0),this._data.length=this._data.items.length,this._initItems(),this.layoutController.setItems(this._data.renderables),this},Carousel.prototype.getSize=function(){return this.getParentSize()},Carousel.prototype.setSize=function(){},Carousel.prototype._init=function(){this.setItems(this.options.items),this.setSelectedIndex(this.options.selectedIndex,!1),this._initContent(),this._events(),Timer.after(function(){this._resize(),this.setContentLayout(this.options.contentLayout)}.bind(this),2)},Carousel.prototype._initContent=function(){this._eventContainer=new Surface,this._eventContainer.pipe(this),this.add(new Modifier({opacity:0})).add(this._eventContainer),this.options.arrowsEnabled&&(this.arrows=new Arrows({position:this.options.arrowsPosition,padding:this.options.arrowsPadding,previousIconURL:this.options.arrowsPreviousIconURL,nextIconURL:this.options.arrowsNextIconURL,animateOnClick:this.options.arrowsAnimateOnClick,toggleDisplayOnHover:this.options.arrowsToggleDisplayOnHover}),this.add(this.arrows)),this.options.dotsEnabled&&(this.dots=new Dots({position:this.options.dotsPosition,padding:this.options.dotsPadding,size:this.options.dotsSize,horizontalSpacing:this.options.dotsHorizontalSpacing,length:Math.ceil(this._data.items.length/this._data.itemsPerPage),selectedIndex:this.options.selectedIndex,arrowsToggleDisplayOnHover:this.options.arrowsToggleDisplayOnHover}),this.add(this.dots)),this._sizeModifier=new Modifier({size:this._getCarouselSize(),origin:[.5,.5],align:[.5,.5]}),this.add(this._sizeModifier).add(this.layoutController)},Carousel.prototype._initItems=function(){for(var t=0;t<this._data.items.length;t++){if(this._data.items[t].render)this._data.renderables.push(this._data.items[t]);else{var e=new Slide(this._data.items[t]);this._data.renderables.push(e)}this._data.renderables[t].pipe(this.sync),this._data.renderables[t].on("click",this._addToClickQueue.bind(this,Carousel.EVENTS.itemClick,t))}},Carousel.prototype._events=function(){this._eventInput.on("parentResize",this._resize.bind(this));var t=[];this.options.touchEnabled&&t.push("touch"),this.options.mouseEnabled&&t.push("mouse"),this.sync.addSync(t),this._eventContainer.pipe(this.sync);var e=null;this.sync.on("start",function(){e=new Date}),this.sync.on("end",function(){this.clickLength=new Date-e}.bind(this)),this.options.keyboardEnabled&&(this._handleKeyup=Carousel._handleKeyup.bind(this),Engine.on("keyup",this._handleKeyup)),this.arrows&&(this.arrows.on("previous",function(){this.previous(),this._eventOutput.emit(Carousel.EVENTS.selection,this._data.index)}.bind(this)),this.arrows.on("next",function(){this.next(),this._eventOutput.emit(Carousel.EVENTS.selection,this._data.index)}.bind(this))),this.options.arrowsToggleDisplayOnHover&&this.arrows&&(this._eventInput.on("mouseover",this.arrows.show.bind(this.arrows)),this._eventInput.on("mouseout",this.arrows.hide.bind(this.arrows))),this.dots&&this.dots.on("set",function(t){this.setSelectedIndex(t*this._data.itemsPerPage),this._eventOutput.emit(Carousel.EVENTS.selection,this._data.index)}.bind(this)),this.dots&&this.arrows&&(this.dots.on("showArrows",this.arrows.show.bind(this.arrows)),this.dots.on("hideArrows",this.arrows.hide.bind(this.arrows))),this.layoutController.on("paginationChange",this._setItemsPerPage.bind(this)),this.layoutController.on("previous",function(){this.previous(),this._eventOutput.emit(Carousel.EVENTS.selection,this._data.index)}.bind(this)),this.layoutController.on("next",function(){this.next(),this._eventOutput.emit(Carousel.EVENTS.selection,this._data.index)}.bind(this)),this.layoutController.on("set",function(t){this.setSelectedIndex(t),this._eventOutput.emit(Carousel.EVENTS.selection,this._data.index)}.bind(this))},Carousel.prototype._addToClickQueue=function(t,e){this.clickLength<150&&this._eventOutput.emit(t,e)},Carousel.prototype._setItemsPerPage=function(t){this._data.itemsPerPage!==t&&(this._data.itemsPerPage=t,this.dots&&this.dots.setLength(Math.ceil(this._data.items.length/t),t,this._data.index))},Carousel.prototype._resize=function(){var t=this._getCarouselSize();this.layoutController.setSize(t),this._sizeModifier.setSize(t)},Carousel.prototype._getCarouselSize=function(){var t=[],e=this.getSize();return this._isPlugin?(t[0]=e[0]-this.options.contentPadding[0],t[1]=e[1]-this.options.contentPadding[1]):(t[0]="number"==typeof this.options.carouselSize[0]?this.options.carouselSize[0]:parseFloat(this.options.carouselSize[0])/100*e[0],t[1]="number"==typeof this.options.carouselSize[1]?this.options.carouselSize[1]:parseFloat(this.options.carouselSize[1])/100*e[1]),t},Carousel.prototype._clamp=function(t,e){return"undefined"==typeof e&&(e=this.options.loop),t>this._data.length-1?t=e?0:this._data.length-1:0>t&&(t=e?this._data.length-1:0),t},Carousel.SingularSoftScale=LayoutFactory.SingularSoftScale,Carousel.SingularTwist=LayoutFactory.SingularTwist,Carousel.SingularParallax=LayoutFactory.SingularParallax,Carousel.SingularSlideBehind=LayoutFactory.SingularSlideBehind,Carousel.SingularOpacity=LayoutFactory.SingularOpacity,Carousel.SingularSlideIn=LayoutFactory.SingularSlideIn,Carousel.SequentialLayout=LayoutFactory.SequentialLayout,Carousel.GridLayout=LayoutFactory.GridLayout,Carousel.CoverflowLayout=LayoutFactory.CoverflowLayout,Carousel.DEFAULT_OPTIONS={contentLayout:Carousel.SingularSoftScale,carouselSize:["100%","100%"],arrowsEnabled:!0,arrowsPosition:"middle",arrowsPadding:[10,0],arrowsPreviousIconURL:void 0,arrowsNextIconURL:void 0,arrowsAnimateOnClick:!0,arrowsToggleDisplayOnHover:!0,dotsEnabled:!0,dotsPosition:"middle",dotsPadding:[0,-10],dotsSize:[10,10],dotsHorizontalSpacing:10,contentPadding:[0,0],selectedIndex:0,items:[],loop:!0,keyboardEnabled:!0,mouseEnabled:!0,touchEnabled:!0},module.exports=Carousel},{"./components/Arrows":45,"./components/Dots":46,"./constructors/SizeAwareView":47,"./layouts/LayoutController":54,"./layouts/LayoutFactory":55,"./registries/Easing":64,"./registries/Physics":65,"./slides/Slide":66,"famous/core/Engine":4,"famous/core/Modifier":8,"famous/core/RenderNode":10,"famous/core/Surface":12,"famous/inputs/FastClick":16,"famous/inputs/GenericSync":17,"famous/inputs/MouseSync":18,"famous/inputs/ScrollSync":19,"famous/inputs/TouchSync":20,"famous/utilities/Timer":41}],45:[function(require,module,exports){function Arrows(){View.apply(this,arguments),this._storage={prev:{surface:null,positionMod:null,animationMod:null,transTransform:null,opacityTrans:null},next:{surface:null,positionMod:null,animationMod:null,transTransform:null,opacityTrans:null}},this._arrowsDisplayed=this.options.toggleDisplayOnHover?!1:!0,this._animationQueue={showCount:0,hideCount:0},this._init()}var View=require("famous/core/View"),Modifier=require("famous/core/Modifier"),ImageSurface=require("famous/surfaces/ImageSurface"),Surface=require("famous/core/Surface"),Transform=require("famous/core/Transform"),Transitionable=require("famous/transitions/Transitionable"),TransitionableTransform=require("famous/transitions/TransitionableTransform"),Timer=require("famous/utilities/Timer");Arrows.prototype=Object.create(View.prototype),Arrows.prototype.constructor=Arrows,Arrows.DEFAULT_OPTIONS={position:"center",padding:[10,0],previousIconURL:void 0,nextIconURL:void 0,animateOnClick:!0,toggleDisplayOnHover:!0},Arrows.POSITION_TO_ALIGN={bottom:1,middle:.5,top:0},Arrows.ANIMATION_OPTIONS={click:{offset:10,transition:{curve:"outBack",duration:250}},display:{curve:"outExpo",duration:600}},Arrows.prototype.show=function(){this._arrowsDisplayed||(this._arrowsDisplayed=!0,this._animationQueue.showCount++,this._queueAnimation("show"))},Arrows.prototype.hide=function(){this._arrowsDisplayed&&(this._arrowsDisplayed=!1,this._animationQueue.hideCount++,this._queueAnimation("hide"))},Arrows.prototype._init=function(){this._initContent(),this._events(this)},Arrows.prototype._initContent=function(){var o=this._defineOptions(this.options.position),t=this._arrowsDisplayed?1:0;for(var r in o){var i=this._storage[r];i.positionMod=new Modifier({origin:[.5,.5],align:[.5,.5],transform:Transform.translate(o[r].translation[0],o[r].translation[1])}),i.transTransform=new TransitionableTransform,i.opacityTrans=new Transitionable(0),i.animationMod=new Modifier({transform:i.transTransform,opacity:i.opacityTrans}),i.surface=new ImageSurface({classes:["famous-carousel-arrow",o[r].className],content:o[r].iconURL,size:[!0,!0],properties:o[r].properties}),this.add(i.positionMod).add(i.animationMod).add(i.surface),Timer.after(function(t,r,i){t.positionMod.setOrigin(o[r].placement),t.positionMod.setAlign(o[r].placement),t.opacityTrans.set(i)}.bind(null,i,r,t),2)}},Arrows.prototype._defineOptions=function(o){var t=this.options.padding,r=2,i=5,n={border:r+"px solid #404040",padding:i+"px",borderRadius:"50%",zIndex:2},e={prev:{className:"famous-carousel-arrow-previous"},next:{className:"famous-carousel-arrow-next"}},s=-r-r;void 0===this.options.previousIconURL?(e.prev.iconURL="/images/icons/arrow_left_dark.svg",e.prev.properties=n):(e.prev.iconURL=this.options.previousIconURL,e.prev.properties={zIndex:2}),void 0===this.options.nextIconURL?(e.next.iconURL="/images/icons/arrow_right_dark.svg",e.next.properties=n,e.next.extraXPadding=s):(e.next.iconURL=this.options.nextIconURL,e.next.properties={zIndex:2},e.next.extraXPadding=0);var a;return a="top"===o?0:"middle"===o?s/2:s,e.prev.placement=[0,Arrows.POSITION_TO_ALIGN[o]],e.prev.translation=[t[0],a-t[1]],e.next.placement=[1,Arrows.POSITION_TO_ALIGN[o]],e.next.translation=[s-t[0],a-t[1]],e},Arrows.prototype._events=function(){var o=this._storage.prev.surface,t=this._storage.next.surface;o.on("click",this._onPrev.bind(this)),t.on("click",this._onNext.bind(this)),this.options.toggleDisplayOnHover&&(o.on("mouseover",this.show.bind(this)),t.on("mouseover",this.show.bind(this)),o.on("mouseout",this.hide.bind(this)),t.on("mouseout",this.hide.bind(this)))},Arrows.prototype._onPrev=function(){this._eventOutput.emit("previous"),this._animateArrow(this._storage.prev.transTransform,-1)},Arrows.prototype._onNext=function(){this._eventOutput.emit("next"),this._animateArrow(this._storage.next.transTransform,1)},Arrows.prototype._animateArrow=function(o,t){if(this.options.animateOnClick){var r=Arrows.ANIMATION_OPTIONS.click;o.halt(),o.set(Transform.translate(r.offset*t,0),{duration:1},function(){o.set(Transform.identity,r.transition)})}},Arrows.prototype._queueAnimation=function(){var o=this._animationQueue;Timer.setTimeout(function(){for(;o.showCount>0&&o.hideCount>0;)o.showCount--,o.hideCount--;o.showCount>0?(o.showCount--,this._showOrHide("show")):o.hideCount>0&&(o.hideCount--,this._showOrHide("hide"))}.bind(this),25)},Arrows.prototype._showOrHide=function(o){var t,r,i,n=Arrows.ANIMATION_OPTIONS.display,e=n.duration,s=1.2;"show"===o?(t=1,r=1,i=0):(t=0,r=.001,i=e/2);var a=this._storage.prev.opacityTrans,u=this._storage.next.opacityTrans,p=this._storage.prev.transTransform,c=this._storage.next.transTransform;a.halt(),u.halt(),p.halt(),c.halt(),a.delay(i,function(){a.set(t,{duration:e/2,curve:"outBack"}),u.set(t,{duration:e/2,curve:"outBack"})}),p.set(Transform.scale(s,s),{duration:1*e/4,curve:n.curve},function(){p.set(Transform.scale(r,r),{duration:3*e/4,curve:n.curve})}),c.set(Transform.scale(s,s),{duration:1*e/4,curve:n.curve},function(){c.set(Transform.scale(r,r),{duration:3*e/4,curve:n.curve})})},module.exports=Arrows},{"famous/core/Modifier":8,"famous/core/Surface":12,"famous/core/Transform":13,"famous/core/View":14,"famous/surfaces/ImageSurface":32,"famous/transitions/Transitionable":37,"famous/transitions/TransitionableTransform":38,"famous/utilities/Timer":41}],46:[function(require,module,exports){function Dots(){SizeAwareView.apply(this,arguments),this._data={dots:[],parentSize:[],dotCount:this.options.length,layoutModel:[],selectedIndex:this.options.selectedIndex},this.layout=new SequentialLayout({defaultItemSize:this.options.size}),this.positionMod=new Modifier,this.animationMod=new Modifier,this.opacityTrans=new Transitionable(1),this.transTransform=new TransitionableTransform,this.displayed=!0,EventHelpers.when(function(){return 0!==this.getParentSize().length}.bind(this),this._init.bind(this))}var SizeAwareView=require("../constructors/SizeAwareView"),Surface=require("famous/core/Surface"),Modifier=require("famous/core/Modifier"),RenderNode=require("famous/core/RenderNode"),Transform=require("famous/core/Transform"),Transitionable=require("famous/transitions/Transitionable"),TransitionableTransform=require("famous/transitions/TransitionableTransform"),SequentialLayout=require("famous/views/SequentialLayout"),Timer=require("famous/utilities/Timer"),EventHelpers=require("../events/EventHelpers");Dots.prototype=Object.create(SizeAwareView.prototype),Dots.prototype.constructor=Dots,Dots.DEFAULT_OPTIONS={position:"center",padding:[0,-10],size:[10,10],horizontalSpacing:10,length:1,selectedIndex:0},Dots.POSITION_TO_ALIGN={left:0,middle:.5,right:1},Dots.ANIMATION_OPTIONS={click:{offset:-7,transition:{curve:"outExpo",duration:250}},display:{scaleUp:1.15,duration:600,curve:"outExpo"}},Dots.prototype.setIndex=function(t){if(t!==this._data.selectedIndex&&!(t>=this._data.dots.length||0>t)){var e=this._data.selectedIndex;this._data.dots[e].surface.removeClass("famous-carousel-dot-selected"),this._data.dots[t].surface.addClass("famous-carousel-dot-selected"),this._data.selectedIndex=t}},Dots.prototype.show=function(t){if(!this.displayed){this.opacityTrans.halt(),this.transTransform.halt(),this.displayed=!0;var e=Dots.ANIMATION_OPTIONS.display;this.opacityTrans.set(1,{duration:100,curve:"inExpo"}),this.transTransform.set(Transform.identity),this.transTransform.set(Transform.scale(e.scaleUp,e.scaleUp),{duration:1*e.duration/3,curve:"outExpo"},function(){this.transTransform.set(Transform.identity,{duration:2*e.duration/3,curve:e.curve},t)}.bind(this))}},Dots.prototype.hide=function(t){if(this.displayed){this.opacityTrans.halt(),this.transTransform.halt(),this.displayed=!1;var e=Dots.ANIMATION_OPTIONS.display;this.opacityTrans.set(1,{duration:e.duration,curve:e.curve}),this.transTransform.set(Transform.scale(e.scaleUp,e.scaleUp),{duration:.25*e.duration,curve:"outExpo"},function(){this.transTransform.set(Transform.scale(1e-4,1e-4),{duration:.75*e.duration,curve:e.curve},t)}.bind(this))}},Dots.prototype.setLength=function(t,e,i){this._data.dotCount=t,this._data.selectedIndex=Math.floor(this._data.selectedIndex/e),this.hide(function(){this._init(),this.setIndex(i),Timer.after(this.show.bind(this),1)}.bind(this))},Dots.prototype._init=function(){this._data.parentSize=this.getParentSize(),this._initContent(),this._createLayout()},Dots.prototype._initContent=function(){this._data.dots=[];for(var t=0;t<this._data.dotCount;t++)this._data.dots.push(this._createNode(t))},Dots.prototype._createNode=function(t){var e={};return e.index=t,e.surface=new Surface({classes:["famous-carousel-dot"],size:this.options.size,properties:{zIndex:2}}),t===this._data.selectedIndex&&e.surface.addClass("famous-carousel-dot-selected"),e.surface.on("click",this._changeIndex.bind(this,e)),this.options.toggleArrowsDisplayOnHover&&(e.surface.on("mouseover",this._eventOutput.emit.bind(this._eventOutput,"showArrows")),e.surface.on("mouseout",this._eventOutput.emit.bind(this._eventOutput,"hideArrows"))),e.transTransform=new TransitionableTransform,e.modifier=new Modifier({transform:e.transTransform}),e.renderNode=new RenderNode,e.renderNode.add(e.modifier).add(e.surface),e},Dots.prototype._createLayout=function(){var t=this._createLayoutModel();1===t.length?(this.layout.setOptions({direction:0,itemSpacing:this.options.horizontalSpacing}),this.layout.sequenceFrom(t[0])):this._createNestedLayout(),this._addLayout()},Dots.prototype._createNestedLayout=function(){var t=[],e=this.options.horizontalSpacing;this.layout.setOptions({direction:1,itemSpacing:e}),this.layout.sequenceFrom(t);for(var i,s=this._data.layoutModel,o=0;o<s.length;o++)if(i=new SequentialLayout({direction:0,itemSpacing:e,defaultItemSize:this.options.size}),i.sequenceFrom(s[o]),o===s.length-1&&s.length>1){var a=new RenderNode;a.add(new Modifier({origin:[Dots.POSITION_TO_ALIGN[this.options.position],0]})).add(i),t.push(a)}else t.push(i)},Dots.prototype._addLayout=function(){var t=Dots.POSITION_TO_ALIGN[this.options.position];this.positionMod.setOrigin([t,1]),this.positionMod.setAlign([t,1]),this.positionMod.setTransform(Transform.translate(this.options.padding[0],this.options.padding[1])),this.animationMod.setOpacity(this.opacityTrans),this.animationMod.setTransform(this.transTransform),this.add(this.positionMod).add(this.animationMod).add(this.layout)},Dots.prototype._createLayoutModel=function(){var t=this._data.parentSize[0],e=[];e.push([]);for(var i=0,s=0,o=this.options.size[0]+this.options.horizontalSpacing,a=this._data.dots,n=0;n<a.length;n++)s+o>t&&(i++,s=0,e.push([])),s+=o,e[i].push(a[n].renderNode);return this._data.layoutModel=e,e},Dots.prototype._changeIndex=function(t){this._eventOutput.emit("set",t.index),this._animateDot(t.transTransform)},Dots.prototype._animateDot=function(t){var e=Dots.ANIMATION_OPTIONS.click;t.set(Transform.translate(0,e.offset),{duration:1},function(){t.set(Transform.identity,e.transition)})},module.exports=Dots},{"../constructors/SizeAwareView":47,"../events/EventHelpers":49,"famous/core/Modifier":8,"famous/core/RenderNode":10,"famous/core/Surface":12,"famous/core/Transform":13,"famous/transitions/Transitionable":37,"famous/transitions/TransitionableTransform":38,"famous/utilities/Timer":41,"famous/views/SequentialLayout":43}],47:[function(require,module,exports){function SizeAwareView(){View.apply(this,arguments),this.__id=Entity.register(this),this.__parentSize=[]}var View=require("famous/core/View"),Entity=require("famous/core/Entity"),Transform=require("famous/core/Transform");SizeAwareView.prototype=Object.create(View.prototype),SizeAwareView.prototype.constructor=SizeAwareView,SizeAwareView.prototype.commit=function(e){var i=e.transform,t=e.opacity,r=e.origin;return this.__parentSize&&this.__parentSize[0]===e.size[0]&&this.__parentSize[1]===e.size[1]||(this.__parentSize[0]=e.size[0],this.__parentSize[1]=e.size[1],this._eventInput.emit("parentResize",this.__parentSize)),this.__parentSize&&(i=Transform.moveThen([-this.__parentSize[0]*r[0],-this.__parentSize[1]*r[1],0],i)),{transform:i,opacity:t,size:this.__parentSize,target:this._node.render()}},SizeAwareView.prototype.getParentSize=function(){return this.__parentSize},SizeAwareView.prototype.render=function(){return this.__id},module.exports=SizeAwareView},{"famous/core/Entity":5,"famous/core/Transform":13,"famous/core/View":14}],48:[function(require,module,exports){module.exports=-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0},{}],49:[function(require,module,exports){function when(e,r,n){n||(n=1),e instanceof Array||(e=[e]);var i=Timer.every(function(){for(var n=0;n<e.length;n++)if(!e[n]())return;r(),Timer.clear(i)},n)}function dualPipe(e,r){e.pipe(r),r.pipe(e)}function clear(e){Engine.removeListener("prerender",e)}function frameQueue(e,r){var n=r,i=function(){r--,0>=r&&(e(),clear(i))};return Engine.on("prerender",i),function(){r=n}}var Timer=require("famous/utilities/Timer"),Engine=require("famous/core/Engine");module.exports={when:when,dualPipe:dualPipe,frameQueue:frameQueue}},{"famous/core/Engine":4,"famous/utilities/Timer":41}],50:[function(require,module,exports){function extend(e,t){for(var r in t)e[r]=t[r]}function inherits(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e}function merge(e,t){var r={};return extend(r,e),extend(r,t),r}module.exports={extend:extend,inherits:inherits,merge:merge}},{}],51:[function(require,module,exports){function CoverflowLayout(t){Layout.call(this,t),this._touchOffset=0,this._offsetT=0,this.boundTouchStart=this._onSyncStart.bind(this),this.boundTouchUpdate=this._onSyncUpdate.bind(this),this.boundTouchEnd=this._onSyncEnd.bind(this),this.step}var Layout=require("./Layout"),ObjectHelpers=require("../helpers/ObjectHelpers"),Transform=require("famous/core/Transform"),Transitionable=require("famous/transitions/Transitionable"),IsIE=require("../dom/IE");CoverflowLayout.prototype=Object.create(Layout.prototype),CoverflowLayout.prototype.constructor=CoverflowLayout,CoverflowLayout.id="CoverflowLayout",CoverflowLayout.DEFAULT_OPTIONS={transition:{curve:"outExpo",duration:1e3},radiusPercent:.5,dimension1:"x",dimension2:"z"};var DIRECTION={x:0,y:1,z:2},UNUSED_DIRECTION={1:"z",2:"y",3:"x"};CoverflowLayout.prototype.activate=function(){this._bindSyncEvents(),this.resetChildProperties(),this.layout()},CoverflowLayout.prototype._getRadius=function(t){return t||(t=this.controller.getSize()[0]),t*this.options.radiusPercent},CoverflowLayout.prototype.layout=function(t){var o=this.controller.getSize(),e=this.controller.items[this.controller.index].getSize(),i=this.controller.nodes.length;this.step=2*Math.PI/i;var r=this._getParametricCircle({x1:.5*o[0],y1:o[0]*-.5,radius:this._getRadius(o[0])}),n=[.5*(o[0]-e[0]),.5*(o[1]-e[1]),0],s=[];if(s[0]="x"===this.options.dimension1||"x"===this.options.dimension2?0:n[0],s[1]="y"===this.options.dimension1||"y"===this.options.dimension2?0:n[1],s[2]=0,IsIE)var a=[];for(var h=0;i>h;h++){var l=this.controller._sanitizeIndex(this.controller.index+h),c=this.data.parentTransforms[l],u=(this.data.opacities[l],r(this.step*h+.5*Math.PI+this._touchOffset)),d=s.slice();d[DIRECTION[this.options.dimension1]]+=o[0]-u[0]-.5*e[0],d[DIRECTION[this.options.dimension2]]+=u[1],IsIE&&a.push(d[2]),t?c.set(Transform.translate(d[0],d[1],d[2])):c.set(Transform.translate(d[0],d[1],d[2]),this.options.transition)}IsIE&&!t&&this.forceZIndex(a),c.set(Transform.translate(d[0],d[1],d[2]),this.options.transition);var p=this.options.transition.duration||this.options.transition.period;p*=.5;for(var f=t?void 0:{curve:"linear",duration:p},h=0;h<this.controller.renderLimit[0];h++){var y=this.data.opacities[this.controller._sanitizeIndex(this.controller.index+1+h)];y&&(y.halt(),y.set(1-h/this.controller.renderLimit[0],f))}for(var h=0;h<this.controller.renderLimit[1];h++){var y=this.data.opacities[this.controller._sanitizeIndex(this.controller.index-1-h)];y&&(y.halt(),y.set(1-h/this.controller.renderLimit[1],f))}this.data.opacities[this.controller.index].halt(),this.data.opacities[this.controller.index].set(1,f)},CoverflowLayout.prototype.deactivate=function(){if(this.controller.isLastLayoutSingular=!1,IsIE)for(var t=0;t<this.controller.nodes.length;t++)this.controller.items[t].setProperties({zIndex:""});this._unbindSyncEvents()},CoverflowLayout.prototype.getRenderLimit=function(){return[Math.min(10,Math.ceil(.5*this.controller.nodes.length)),Math.min(10,Math.ceil(.5*this.controller.nodes.length))]},CoverflowLayout.prototype.forceZIndex=function(t){for(var o=0;o<this.controller.nodes.length;o++){var e=this.controller._sanitizeIndex(this.controller.index+o);this.controller.items[e].setProperties({zIndex:Math.round(t[o])})}},CoverflowLayout.prototype._bindSyncEvents=function(){this.controller.sync.on("start",this.boundTouchStart),this.controller.sync.on("update",this.boundTouchUpdate),this.controller.sync.on("end",this.boundTouchEnd)},CoverflowLayout.prototype._unbindSyncEvents=function(){this.controller.sync.removeListener("start",this.boundTouchStart),this.controller.sync.removeListener("update",this.boundTouchUpdate),this.controller.sync.removeListener("end",this.boundTouchEnd)},CoverflowLayout.prototype._onSyncStart=function(t){this._offsetT=Math.acos(t.position[0]/this._getRadius())},CoverflowLayout.prototype._onSyncUpdate=function(t){for(var o=t.position[0]/this._getRadius();o>1;)o-=2;for(;-1>o;)o+=2;var e=Math.acos(o);this._touchOffset=this._offsetT-e,this.layout(!0)},CoverflowLayout.prototype._onSyncEnd=function(t){var o=.1*t.velocity[0],e=Math.round((-this._touchOffset-o)/this.step);this._touchOffset=0,this.controller._eventOutput.emit("set",this.controller._sanitizeIndex(this.controller.index+e))},CoverflowLayout.prototype._getParametricCircle=function(t){var o={x1:0,y1:0,radius:20};return ObjectHelpers.extend(o,t),function(t){return[o.x1+o.radius*Math.cos(t),o.y1+o.radius*Math.sin(t)]}},module.exports=CoverflowLayout},{"../dom/IE":48,"../helpers/ObjectHelpers":50,"./Layout":53,"famous/core/Transform":13,"famous/transitions/Transitionable":37}],52:[function(require,module,exports){function GridLayout(t){Layout.call(this,t)}var Layout=require("./Layout"),Transform=require("famous/core/Transform"),Easing=require("famous/transitions/Easing");GridLayout.prototype=Object.create(Layout.prototype),GridLayout.prototype.constructor=GridLayout,GridLayout.id="GridLayout",GridLayout.DEFAULT_OPTIONS={gridDimensions:[3,3],padding:[15,15],selectedItemTransition:{method:"spring",dampingRatio:.65,period:600},transition:{curve:"outExpo",duration:800},delayLength:600},GridLayout.prototype.activate=function(){this.controller._eventOutput.emit("paginationChange",this.options.gridDimensions[0]*this.options.gridDimensions[1]),this.resetChildProperties();var t=this.options.gridDimensions[0]*this.options.gridDimensions[1],o=Math.ceil(this.controller.nodes.length/t),i=Math.floor(this.controller.index/t),e=i*t,n=i===o-1?e+(this.controller.nodes.length-i*t)-1:e+t-1;this._delayTransitions(e,n),this._animateItems(e,n),this._handleTouchEvents()},GridLayout.prototype.layout=function(){for(var t,o=this._getTransforms(),i=0;i<this.controller.nodes.length;i++)t=this.data.parentTransforms[i],t.set(o[i].transform,this.options.transition),this.data.opacities[i].halt(),this.data.opacities[i].set(1,this.options.transition)},GridLayout.prototype.deactivate=function(){this.controller.isLastLayoutSingular=!1,this.controller._eventOutput.emit("paginationChange",this.controller.itemsPerPage),this._removeTouchEvents()},GridLayout.prototype.getRenderLimit=function(){return[0,this.controller.nodes.length]},GridLayout.prototype._handleTouchEvents=function(){this.boundTouchUpdate=function(t){var o=this.data.touchOffset,i=o.get();i[0]+=t.delta[0],o.set([i[0],i[1]])}.bind(this),this.boundTouchEnd=function(){for(var t=this.data.touchOffset,o=t.get(),i=o[0],e=this.controller.getSize()[0],n=0;n<this.controller.items.length;n++){var s=this.data.parentTransforms[n],r=s.translate.get();s.setTranslate([r[0]+o[0],r[1]])}t.set([0,0]),-1*e/5>i?this.controller._eventOutput.emit("next"):i>1*e/5?this.controller._eventOutput.emit("previous"):this.layout()}.bind(this),this._addTouchEvents()},GridLayout.prototype._addTouchEvents=function(){this.controller.sync.on("update",this.boundTouchUpdate),this.controller.sync.on("end",this.boundTouchEnd)},GridLayout.prototype._removeTouchEvents=function(){this.controller.sync.removeListener("update",this.boundTouchUpdate),this.controller.sync.removeListener("end",this.boundTouchEnd)},GridLayout.prototype._delayTransitions=function(t,o){for(var i,e=this.controller.index,n=this.controller.index-1<t?void 0:this.controller.index-1,s=0,r=o-t+1;r>s;){var a=s/(r-1),h=Easing.inOutSine(a);i=h*this.options.delayLength+1,void 0!==e&&(this._setItemDelay(e,i),e=e+1>o?void 0:e+1,s++),void 0!==n&&(this._setItemDelay(n,i),n=t>n-1?void 0:n-1,s++)}},GridLayout.prototype._setItemDelay=function(t,o){trans=this.data.parentTransforms[t],trans.rotate.delay(o),trans.scale.delay(o),trans.translate.delay(o),this.data.opacities[t].delay(o)},GridLayout.prototype._animateItems=function(t,o){for(var i=function(i){return i>=t&&o>=i},e=this._getTransforms(),n=0;n<this.controller.nodes.length;n++){if(i(n))if(n===this.controller.index){var s=this.options.selectedItemTransition.method||"spring",r=this.options.selectedItemTransition.dampingRatio||.65,a=this.options.selectedItemTransition.period||600;this.data.parentTransforms[n].set(e[n].transform,{method:s,dampingRatio:r,period:a})}else this.data.parentTransforms[n].set(e[n].transform,this.options.transition);else this.controller.isLastLayoutSingular||null===this.controller.isLastLayoutSingular?this.data.parentTransforms[n].set(e[n].transform):this.data.parentTransforms[n].set(e[n].transform,this.options.transition);this.data.opacities[n].set(1,this.options.transition)}},GridLayout.prototype._getTransforms=function(){for(var t=this._getGridPositions(this.controller.getSize().slice(0),this.options.padding,this.options.gridDimensions),o=t.cellSize,i=this.controller.getSize().slice(0),e=this.options.gridDimensions[0]*this.options.gridDimensions[1],n=Math.floor(this.controller.index/e),s=[],r=0;r<this.controller.nodes.length;r++){var a=t.at(r);
a[0]-=n*i[0]+n*this.options.padding[0],a[2]=1;var h=this.data.sizeCache[r]||this.data.sizeCache[0],d=Math.min(o[0]/h[0],o[1]/h[1]),l=[.5*Math.round(o[0]-h[0]*d),.5*Math.round(o[1]-h[1]*d)];s.push({transform:Transform.thenMove(Transform.scale(d,d),[a[0]+l[0],a[1]+l[1]]),gridPos:a,maxScale:d})}return s},GridLayout.prototype._getGridPositions=function(t,o,i){var e=[(t[0]-o[0]*Math.max(i[0]-1,0))/i[0],(t[1]-o[1]*Math.max(i[1]-1,0))/i[1]],n=i[0]*i[1];return{at:function(s){var r=Math.floor(s/n),a=s%i[0],h=Math.floor((s-r*n)/i[0]);return[a*e[0]+a*o[0]+r*t[0]+r*o[0],h*e[1]+h*o[1]]},cellSize:e}},module.exports=GridLayout},{"./Layout":53,"famous/core/Transform":13,"famous/transitions/Easing":33}],53:[function(require,module,exports){function Layout(t){var o=Utility.clone(this.constructor.DEFAULT_OPTIONS||{});return this.options=ObjectHelpers.merge(o,t),this.id=this.constructor.id,this.controller=null,this.data=null,this}var ObjectHelpers=require("../helpers/ObjectHelpers"),Transform=require("famous/core/Transform"),Utility=require("famous/utilities/Utility");Layout.prototype.setController=function(t){this.controller=t,this.data=t.data},Layout.prototype.resetChildProperties=function(){for(var t=this.options.transition.duration||this.options.transition.period||200,o=0;o<this.controller.nodes.length;o++)this.data.childTransforms[o].set(Transform.identity,{curve:"outExpo",duration:t}),this.data.childOrigins[o].set([0,0]),this.data.childAligns[o].set([0,0])},Layout.prototype.getRenderLimit=function(){},Layout.prototype.activate=function(){},Layout.prototype.layout=function(){},Layout.prototype.deactivate=function(){},module.exports=Layout},{"../helpers/ObjectHelpers":50,"famous/core/Transform":13,"famous/utilities/Utility":42}],54:[function(require,module,exports){function LayoutController(t){SizeAwareView.apply(this,arguments),this.items,this.container,this.index,this.lastIndex,this._activeLayout,this.itemsPerPage=t.itemsPerPage,this.renderLimit=[1,4],this.isLastLayoutSingular=null,this.nodes=[],this.data={opacities:[],parentTransforms:[],parentOrigins:[],parentAligns:[],parentSizes:[],childTransforms:[],childOrigins:[],childAligns:[],touchOffset:new Transitionable([0,0]),sizeCache:[],sizeCacheFull:!1},this._boundLayout=this.layout.bind(this),this._boundActivate=this._activate.bind(this),this.sync=t.sync,this._init()}var Timer=require("famous/utilities/Timer"),Engine=require("famous/core/Engine"),Transform=require("famous/core/Transform"),RenderNode=require("famous/core/RenderNode"),Modifier=require("famous/core/Modifier"),ContainerSurface=require("famous/surfaces/ContainerSurface"),TransitionableTransform=require("famous/transitions/TransitionableTransform"),Transitionable=require("famous/transitions/Transitionable"),LayoutFactory=require("./LayoutFactory"),SizeAwareView=require("../constructors/SizeAwareView"),EventHelpers=require("../events/EventHelpers");LayoutController.prototype=Object.create(SizeAwareView.prototype),LayoutController.prototype.constructor=LayoutController,LayoutController.DEFAULT_OPTIONS={classes:[],loop:void 0,properties:{overflow:"hidden",zIndex:1},perspective:1e3},LayoutController.prototype.setSize=function(t){this.container.setSize(t)},LayoutController.prototype.getSize=function(){return this.container.getSize()},LayoutController.prototype.setItems=function(t){this.items=t,this._reset(),this._createItems(),this.data.sizeCache=new Array(t.length),this.data.sizeCacheFull=!1},LayoutController.prototype.setIndex=function(t,e){this.lastIndex=this.index,this.index=t,this._updateRenderedIndices(),e&&this._safeLayout()},LayoutController.prototype.getLength=function(){return Math.min(this.index+this.renderLimit[0]+this.renderLimit[1],this.nodes.length)},LayoutController.prototype.setRenderLimit=function(t){this.renderLimit=!t instanceof Array?[0,t]:t,this._updateRenderedIndices()},LayoutController.prototype.getLayout=function(){return this._activeLayout},LayoutController.prototype.layout=function(){this._layoutQueue=void 0,this._updateSizeCache(),this.halt(),this._activeLayout&&this._activeLayout.layout()},LayoutController.prototype.setLayout=function(t){t instanceof Function&&(t=new t({})),this._activeLayout&&this._activeLayout.deactivate(),this._activeLayout=t,this._activeLayout.setController(this);var e=this._activeLayout.getRenderLimit();e?this.setRenderLimit(e):this._updateRenderedIndices(),this._safeActivate()},LayoutController.prototype.halt=function(){for(var t=0;t<this.nodes.length;t++)this.data.childOrigins[t].halt(),this.data.childAligns[t].halt(),this.data.childTransforms[t].halt(),this.data.parentOrigins[t].halt(),this.data.parentAligns[t].halt(),this.data.parentTransforms[t].halt(),this.data.opacities[t].halt()},LayoutController.prototype._init=function(){this._createContainer()},LayoutController.prototype._safeLayout=function(){this._layoutQueue?this._layoutQueue():this._layoutQueue=EventHelpers.frameQueue(this._boundLayout,4)},LayoutController.prototype._safeActivate=function(){this._activateQueue?this._activateQueue():this._activateQueue=EventHelpers.frameQueue(this._boundActivate,4)},LayoutController.prototype._activate=function(){this._activateQueue=void 0,this._updateSizeCache(),this.halt(),this._activeLayout.activate()},LayoutController.prototype._updateRenderedIndices=function(){var t=this._previousRender?this._previousRender:[];this.futureIndices=this._calculateFutureIndices(),this._toRender=[];for(var e=0;e<t.length;e++)this._toRender.push(t[e]);for(var e=0;e<this.futureIndices.length;e++)this._toRender.indexOf(this.futureIndices[e])<0&&this._toRender.push(this.futureIndices[e]);this._previousRender=this.futureIndices,this._toRender.sort(function(t,e){return t-e})},LayoutController.prototype._calculateFutureIndices=function(){for(var t=[],e=this.nodes.length,i=0,r=this.renderLimit[0]+this.renderLimit[1],n=0;r>n&&n!=e;n++){var a=this.index-this.renderLimit[0]+n;if(0>a){var o=a%e;if(o=0==o?o:o+e,o==e)continue;t.push(o),i=o>i?o:i}else(0==i||i>a)&&t.push(a%e)}return t},LayoutController.prototype._createContainer=function(){this.container=new ContainerSurface({classes:this.options.classes,properties:this.options.properties}),this.container.context.setPerspective(this.options.perspective);var t=new RenderNode;t.render=this._innerRender.bind(this),this.add(this.container),this.container.add(t)},LayoutController.prototype._connectContainer=function(t){this.container.pipe(t),this.container.pipe(t.sync)},LayoutController.prototype._createItems=function(){for(var t=0;t<this.items.length;t++){var e=this.items[t],i=new Transitionable(1),r=new TransitionableTransform,n=new Transitionable([0,0]),a=new Transitionable([0,0]),o=new Transitionable([void 0,void 0]),s=new TransitionableTransform,h=new Transitionable([0,0]),u=new Transitionable([0,0]),l=new Modifier({transform:r,origin:n,align:a,opacity:i,size:o}),d=new Modifier({transform:s,origin:h,align:u}),c=new Modifier({transform:function(){var t=this.data.touchOffset.get();return Transform.translate(t[0],t[1])}.bind(this)}),p=new RenderNode;p.getSize=e.getSize.bind(e),p.add(c).add(l).add(d).add(e),this.nodes.push(p),this.data.parentTransforms.push(r),this.data.opacities.push(i),this.data.parentOrigins.push(n),this.data.parentAligns.push(a),this.data.parentSizes.push(o),this.data.childTransforms.push(s),this.data.childOrigins.push(h),this.data.childAligns.push(u)}},LayoutController.prototype._reset=function(){this.nodes=[],this.data.parentTransforms=[],this.data.opacities=[],this.data.parentOrigins=[],this.data.parentAligns=[],this.data.parentSizes=[],this.data.childTransforms=[],this.data.childOrigins=[],this.data.childAligns=[],this.data.sizeCache=[],this.data.sizeCacheFull=!1},LayoutController.prototype._sanitizeIndex=function(t){var e=this.nodes.length;return 0>t?t%e+e:t>e-1?t%e:t},LayoutController.prototype._updateSizeCache=function(){if(!this.data.sizeCacheFull){for(var t,e=this.data.sizeCache,i=0,r=0;r<e.length;r++)void 0===e[r]?(t=this.items[r].getSize(),null!==t&&0!=t[0]&&0!=t[1]&&(e[r]=t,this.data.parentSizes[r].set(t),this._eventInput.emit("initialSize",r),i++)):i++;i===e.length&&(this.data.sizeCacheFull=!0)}},LayoutController.prototype._innerRender=function(){for(var t=[],e=0;e<this._toRender.length;e++)t[e]=this.nodes[this._toRender[e]].render();return t},module.exports=LayoutController},{"../constructors/SizeAwareView":47,"../events/EventHelpers":49,"./LayoutFactory":55,"famous/core/Engine":4,"famous/core/Modifier":8,"famous/core/RenderNode":10,"famous/core/Transform":13,"famous/surfaces/ContainerSurface":31,"famous/transitions/Transitionable":37,"famous/transitions/TransitionableTransform":38,"famous/utilities/Timer":41}],55:[function(require,module,exports){var SingularSoftScale=require("./SingularSoftScale"),SingularTwist=require("./SingularTwist"),SingularSlideBehind=require("./SingularSlideBehind"),SingularParallax=require("./SingularParallax"),SingularOpacity=require("./SingularOpacity"),SingularSlideIn=require("./SingularSlideIn"),GridLayout=require("./GridLayout"),CoverflowLayout=require("./CoverflowLayout"),SequentialLayout=require("./SequentialLayout"),LayoutFactory={};LayoutFactory.wrap=function(a){function r(r){return r instanceof a?r:new a(r)}return r.id=a.id,r},LayoutFactory.SingularSoftScale=LayoutFactory.wrap(SingularSoftScale),LayoutFactory.SingularTwist=LayoutFactory.wrap(SingularTwist),LayoutFactory.SingularSlideBehind=LayoutFactory.wrap(SingularSlideBehind),LayoutFactory.SingularParallax=LayoutFactory.wrap(SingularParallax),LayoutFactory.SingularOpacity=LayoutFactory.wrap(SingularOpacity),LayoutFactory.SingularSlideIn=LayoutFactory.wrap(SingularSlideIn),LayoutFactory.GridLayout=LayoutFactory.wrap(GridLayout),LayoutFactory.CoverflowLayout=LayoutFactory.wrap(CoverflowLayout),LayoutFactory.SequentialLayout=LayoutFactory.wrap(SequentialLayout),module.exports=LayoutFactory},{"./CoverflowLayout":51,"./GridLayout":52,"./SequentialLayout":56,"./SingularOpacity":58,"./SingularParallax":59,"./SingularSlideBehind":60,"./SingularSlideIn":61,"./SingularSoftScale":62,"./SingularTwist":63}],56:[function(require,module,exports){function SequentialLayout(t){Layout.call(this,t),this.applyPreAnimationOffset=[],this.useTouchEndTransition=!1}var Layout=require("./Layout"),Transform=require("famous/core/Transform"),Easing=require("famous/transitions/Easing");SequentialLayout.prototype=Object.create(Layout.prototype),SequentialLayout.prototype.constructor=SequentialLayout,SequentialLayout.id="SequentialLayout",SequentialLayout.DEFAULT_OPTIONS={transition:{duration:800,curve:"outExpo"},touchEndTransition:{method:"snap",period:200},padding:[10,0],direction:"x"},SequentialLayout.prototype.activate=function(){this.resetChildProperties();for(var t=0;t<this.controller.nodes.length;t++)this.data.opacities[t].set(1,this.options.transition);this.containerSize=this.controller.getSize(),this.layout(),this._handleTouchEvents()},SequentialLayout.prototype.layout=function(){for(var t,e,i="y"===this.options.direction?1:0,o=1===i?0:1,n=this.controller.index,s=this.controller.nodes.length-1,a=[],r=[0,0],h=1;h<=this.controller.renderLimit[0];h++)t=this.controller._sanitizeIndex(n-h),e=this._getCenteredPosition(t,o),r[o]=e[o],r[i]-=this.data.sizeCache[t][i]+this.options.padding[i],a[t]=Transform.translate(r[0],r[1]);for(var u=[0,0],h=0;h<this.controller.renderLimit[1]&&(t=this.controller._sanitizeIndex(n+h),e=this._getCenteredPosition(t,o),this.controller.options.loop===!0||t>=n);h++)a[t]=this._getTransform(t,u,o),u[i]+=this.data.sizeCache[t][i]+this.options.padding[i];var c=0;if(!this.controller.options.loop&&a[s]&&this.data.sizeCache[s]){var l=0===i?a[s][12]:a[s][13];if(l>=0){var d=l+this.data.sizeCache[t][i];d<this.containerSize[i]&&(c=this.containerSize[i]-d)}}var p=this.options.transition;this.useTouchEndTransition&&(p=this.options.touchEndTransition,this.useTouchEndTransition=!1);for(var h=0;h<this.controller.nodes.length;h++)if(a[h]){if(this.applyPreAnimationOffset[h]){var f=0===i?a[h][12]:a[h][13],y=0>f?-1:1;e=this._getCenteredPosition(h,o);var T=[];T[i]=this.containerSize[i]*y,T[o]=e[o],this.data.parentTransforms[h].set(Transform.translate(T[0],T[1])),this.applyPreAnimationOffset[h]=!1}0===i?a[h][12]+=c:a[h][13]+=c,this.data.parentTransforms[h].set(a[h],p),this.data.opacities[h].set(1,p)}else this.data.parentTransforms[h].set(Transform.translate(this.containerSize[0],this.containerSize[1])),this.data.opacities[h].set(0),this.applyPreAnimationOffset[h]=!0},SequentialLayout.prototype.deactivate=function(){this.isLastLayoutSingular=!1,this._removeTouchEvents()},SequentialLayout.prototype.getRenderLimit=function(){return[5,Math.min(10,this.controller.nodes.length)]},SequentialLayout.prototype._handleTouchEvents=function(){var t="y"===this.options.direction?1:0;this.boundTouchUpdate=function(e){var i=this.data.touchOffset,o=i.get();o[t]+=e.delta[t],i.set([o[0],o[1]])}.bind(this),this.boundTouchEnd=function(){for(var e=this.data.touchOffset,i=e.get(),o=i[t],n=0;n<this.controller.items.length;n++){var s=this.data.parentTransforms[n],a=s.translate.get();s.setTranslate([a[0]+i[0],a[1]+i[1]])}e.set([0,0]);var r=o>0?-1:1,h=this.controller.index;for(o=Math.abs(o);o>0;)o-=this.data.sizeCache[h][t],h=this.controller._sanitizeIndex(h+r);this.useTouchEndTransition=!0,this.controller._eventOutput.emit("set",h)}.bind(this),this._addTouchEvents()},SequentialLayout.prototype._addTouchEvents=function(){this.controller.sync.on("update",this.boundTouchUpdate),this.controller.sync.on("end",this.boundTouchEnd)},SequentialLayout.prototype._removeTouchEvents=function(){this.controller.sync.removeListener("update",this.boundTouchUpdate),this.controller.sync.removeListener("end",this.boundTouchEnd)},SequentialLayout.prototype._getCenteredPosition=function(t,e){if(void 0===this.data.sizeCache[t])return[0,0];var i=[0,0];return i[e]=.5*(this.containerSize[e]-this.data.sizeCache[t][e]),i},SequentialLayout.prototype._getTransform=function(t,e,i){var o=this._getCenteredPosition(t,i);return Transform.translate(e[0]+o[0],e[1]+o[1])},module.exports=SequentialLayout},{"./Layout":53,"famous/core/Transform":13,"famous/transitions/Easing":33}],57:[function(require,module,exports){function SingularLayout(t){return Layout.call(this,t),this._boundSizeListener=null,this}var Layout=require("./Layout"),Transform=require("famous/core/Transform"),Timer=require("famous/utilities/Timer");SingularLayout.prototype=Object.create(Layout.prototype),SingularLayout.prototype.constructor=SingularLayout,SingularLayout.DEFAULT_OPTIONS={},SingularLayout.prototype.activate=function(){this._boundSizeListener=this.centerItem.bind(this);for(var t=0;t<this.controller.items.length;t++)this.data.childOrigins[t].set([.5,.5]),this.data.childAligns[t].set([.5,.5]),this.data.childTransforms[t].set(Transform.identity),t===this.controller.index?(this.data.opacities[t].set(1,this.options.curve),this.data.sizeCache[t]&&(this.controller.isLastLayoutSingular||null===this.controller.isLastLayoutSingular?this.centerItem(t):this.data.childTransforms[t].set(Transform.scale(.8,.8),{duration:150},function(t){this.centerItem(t,{method:"spring",dampingRatio:.65,period:400}),this.data.childTransforms[t].set(Transform.identity,{duration:150})}.bind(this,t)))):(this.data.childTransforms[t].set(Transform.translate(0,0,-10)),this.data.opacities[t].set(0,{duration:300},function(t){this.data.sizeCache[t]&&this.centerItem(t)}.bind(this,t)));this.controller._eventInput.on("initialSize",this._boundSizeListener),this._handleTouchEvents()},SingularLayout.prototype.layout=function(){for(var t=this.controller.index,i=this.controller.lastIndex,e=this.controller.items.length-1,n=(t>i||0===t&&i===e)&&!(t===e&&0===i),o=this.controller.getSize().slice(0),r=0;r<this.controller.items.length;r++)r===this.controller.index?this.currentItemTransition(this.getItem(r),o,n):r===this.controller.lastIndex?this.previousItemTransition(this.getItem(r),o,n):this.otherItemTransition(this.getItem(r),o)},SingularLayout.prototype.otherItemTransition=function(t){t.opacity.set(0)},SingularLayout.prototype.currentItemTransition=function(){},SingularLayout.prototype.previousItemTransition=function(){},SingularLayout.prototype.deactivate=function(){this.controller.isLastLayoutSingular=!0,this.controller._eventInput.removeListener("initialSize",this._boundSizeListener),this._removeTouchEvents()},SingularLayout.prototype.getRenderLimit=function(){return[1,1]},SingularLayout.prototype.getCenteredPosition=function(t){var i=this.controller.getSize(),e=this.data.sizeCache[t];return[.5*(i[0]-e[0]),.5*(i[1]-e[1])]},SingularLayout.prototype.centerItem=function(t,i){var e=this.controller.getSize(),n=this.data.sizeCache[t];this.data.parentTransforms[t].set(Transform.translate(.5*(e[0]-n[0]),.5*(e[1]-n[1])),i)},SingularLayout.prototype.getItem=function(t){return{item:this.controller.items[t],size:this.data.sizeCache[t],index:t,opacity:this.data.opacities[t],parentOrigin:this.data.parentOrigins[t],parentAlign:this.data.parentAligns[t],parentSize:this.data.parentSizes[t],parentTransform:this.data.parentTransforms[t],childTransform:this.data.childTransforms[t],childOrigin:this.data.childOrigins[t],childAlign:this.data.childAligns[t]}},SingularLayout.prototype._handleTouchEvents=function(){this.boundTouchUpdate=function(t){var i=this.controller.index,e=this.data.sizeCache[i],n=this.data.touchOffset,o=n.get();if(n.set([o[0]+t.delta[0],o[1]]),Math.abs(o[0])>1*e[0]/3){var r=n.get()[0]<0?"previous":"next";this._emitEventFromTouch(t.velocity,r)}}.bind(this),this.boundTouchEnd=function(t){var i=this.data.touchOffset;i.set([0,0],{curve:"outBack",duration:150}),Timer.setTimeout(function(){"function"==typeof t&&t()},100)}.bind(this),this._addTouchEvents()},SingularLayout.prototype._addTouchEvents=function(){this.controller.sync.on("update",this.boundTouchUpdate),this.controller.sync.on("end",this.boundTouchEnd)},SingularLayout.prototype._removeTouchEvents=function(){this.controller.sync.removeListener("update",this.boundTouchUpdate),this.controller.sync.removeListener("end",this.boundTouchEnd)},SingularLayout.prototype._emitEventFromTouch=function(t,i){this._removeTouchEvents();var e=function(){this.controller._eventOutput.emit(i),this._addTouchEvents()}.bind(this);this.boundTouchEnd(e)},module.exports=SingularLayout},{"./Layout":53,"famous/core/Transform":13,"famous/utilities/Timer":41}],58:[function(require,module,exports){function SingularOpacity(t){SingularLayout.call(this,t)}var SingularLayout=require("./SingularLayout"),Transform=require("famous/core/Transform");SingularOpacity.prototype=Object.create(SingularLayout.prototype),SingularOpacity.prototype.constructor=SingularOpacity,SingularOpacity.id="SingularOpacity",SingularOpacity.DEFAULT_OPTIONS={transition:{curve:"linear",duration:500}},SingularOpacity.prototype.currentItemTransition=function(t){t.opacity.set(1,this.options.transition),this.centerItem(this.controller.index)},SingularOpacity.prototype.previousItemTransition=function(t){t.opacity.set(0,this.options.transition),this.centerItem(this.controller.lastIndex)},module.exports=SingularOpacity},{"./SingularLayout":57,"famous/core/Transform":13}],59:[function(require,module,exports){function SingularParallax(a){SingularLayout.call(this,a),this.axis="x"===this.options.direction?0:1}var SingularLayout=require("./SingularLayout"),Transform=require("famous/core/Transform");SingularParallax.prototype=Object.create(SingularLayout.prototype),SingularParallax.prototype.constructor=SingularParallax,SingularParallax.id="SingularParallax",SingularParallax.DEFAULT_OPTIONS={transition:{method:"spring",dampingRatio:.95,period:550},direction:"y",parallaxRatio:.2},SingularParallax.Depth=1,SingularParallax.prototype.currentItemTransition=function(a,r,t){a.opacity.set(1),a.parentTransform.halt();var i,n=this.getCenteredPosition(this.controller.index);t?(i=[n[0],n[1],-2*SingularParallax.Depth],i[this.axis]=-a.size[this.axis]*this.options.parallaxRatio,a.parentTransform.set(Transform.translate(i[0],i[1],i[2])),a.parentTransform.set(Transform.translate(n[0],n[1],n[2]),this.options.transition)):(i=[n[0],n[1],0],i[this.axis]=r[this.axis],a.parentTransform.set(Transform.translate(i[0],i[1],i[2])),a.parentTransform.set(Transform.translate(n[0],n[1],n[2]),this.options.transition)),a.childTransform.set(Transform.identity)},SingularParallax.prototype.previousItemTransition=function(a,r,t){a.opacity.set(1),a.parentTransform.halt();var i=this.getCenteredPosition(this.controller.index);if(a.opacity.set(0,{curve:"linear",duration:this.options.transition.period||this.options.transition.duration}),t){var n=[i[0],i[1],-2];n[this.axis]=r[this.axis],a.parentTransform.set(Transform.translate(n[0],n[1],n[2]),this.options.transition),a.parentTransform.set(Transform.translate(i[0],i[1],i[2]),{curve:"linear",duration:1})}else{var s=Transform.translate(i[0],i[1],-2),o=[i[0],i[1],-2*SingularParallax.Depth];o[this.axis]=-a.size[this.axis]*this.options.parallaxRatio,a.parentTransform.set(s),a.parentTransform.set(Transform.translate(o[0],o[1],o[2]),this.options.transition)}},module.exports=SingularParallax},{"./SingularLayout":57,"famous/core/Transform":13}],60:[function(require,module,exports){function SingularSlideBehind(i){SingularLayout.call(this,i)}var SingularLayout=require("./SingularLayout"),Transform=require("famous/core/Transform"),IsIE=require("../dom/IE");SingularSlideBehind.prototype=Object.create(SingularLayout.prototype),SingularSlideBehind.prototype.constructor=SingularSlideBehind,SingularSlideBehind.id="SingularSlideBehind",SingularSlideBehind.DEFAULT_OPTIONS={duration:600,rotationAngle:Math.PI/4},SingularSlideBehind.FirstCurve="easeInOut",SingularSlideBehind.SecondCurve="easeInOut",SingularSlideBehind.DurationRatio=1/3,SingularSlideBehind.OffsetFactor=.5,SingularSlideBehind.zIndex=-500,SingularSlideBehind.prototype.currentItemTransition=function(i,e,n){var r,t,a,o;n?(r=[.5,1],t=[.5,1],a=1,o=i.size[1]*SingularSlideBehind.OffsetFactor):(r=[.5,0],t=[.5,0],a=-1,o=i.size[1]*SingularSlideBehind.OffsetFactor*-1);var d=this.options.duration*SingularSlideBehind.DurationRatio,l=(this.options.duration-d,{duration:d,curve:SingularSlideBehind.FirstCurve}),s={duration:d,curve:SingularSlideBehind.SecondCurve};i.childOrigin.set(r),i.childAlign.set(t),i.opacity.set(1,l),i.childTransform.set(Transform.multiply(Transform.translate(0,0,SingularSlideBehind.zIndex),Transform.rotateX(this.options.rotationAngle*a))),i.childTransform.set(Transform.translate(0,o,SingularSlideBehind.zIndex/2),l,function(){IsIE&&i.item.setProperties({zIndex:1}),i.childTransform.set(Transform.identity,s)}),this.centerItem(this.controller.index)},SingularSlideBehind.prototype.previousItemTransition=function(i,e,n){var r,t,a,o;n?(r=[.5,0],t=[.5,0],a=-1,o=i.size[1]*SingularSlideBehind.OffsetFactor*-1):(r=[.5,1],t=[.5,1],a=1,o=i.size[1]*SingularSlideBehind.OffsetFactor);var d=this.options.duration*SingularSlideBehind.DurationRatio,l={duration:d,curve:SingularSlideBehind.FirstCurve},s={duration:this.options.duration-d,curve:SingularSlideBehind.SecondCurve};i.childOrigin.set(r),i.childAlign.set(t),i.childTransform.set(Transform.multiply(Transform.translate(0,o),Transform.rotateX(this.options.rotationAngle*a)),l,function(){IsIE&&i.item.setProperties({zIndex:-1}),i.opacity.set(0,s),i.childTransform.set(Transform.translate(0,0,SingularSlideBehind.zIndex),s)}.bind(this)),this.centerItem(this.controller.lastIndex)},module.exports=SingularSlideBehind},{"../dom/IE":48,"./SingularLayout":57,"famous/core/Transform":13}],61:[function(require,module,exports){function SingularSlideIn(i){SingularLayout.call(this,i),this.options.direction=this.options.direction.toLowerCase()}var SingularLayout=require("./SingularLayout"),Transform=require("famous/core/Transform");SingularSlideIn.prototype=Object.create(SingularLayout.prototype),SingularSlideIn.prototype.constructor=SingularSlideIn,SingularSlideIn.id="SingularSlideIn",SingularSlideIn.DEFAULT_OPTIONS={transition:{curve:"easeOut",duration:600},delayRatio:.15,direction:"y"},SingularSlideIn.prototype.currentItemTransition=function(i,t,o){var n=this.options.transition,r=n.duration||n.period,e=r*this.options.delayRatio;r-=e;var a,s,l=n.method?{period:r,method:n.method,dampingRatio:n.dampingRatio}:{duration:r,curve:n.curve};o?"x"===this.options.direction?(a=t[0],s=0):(a=0,s=-1*t[1]):"x"===this.options.direction?(a=-1*t[0],s=0):(a=0,s=t[1]),i.opacity.set(1),i.childTransform.set(Transform.translate(a,s)),i.opacity.delay(e,function(){i.childTransform.set(Transform.translate(0,0),l)}),this.centerItem(this.controller.index)},SingularSlideIn.prototype.previousItemTransition=function(i,t,o){var n,r,e;o?("x"===this.options.direction?(n=[0,.5],r=[0,.5]):(n=[.5,1],r=[.5,1]),e=1):("x"===this.options.direction?(n=[1,.5],r=[1,.5]):(n=[.5,0],r=[.5,0]),e=-1),i.childOrigin.set(n),i.childAlign.set(r),"x"===this.options.direction?i.childTransform.set(Transform.rotateY(Math.PI/4*e),this.options.transition):i.childTransform.set(Transform.rotateX(Math.PI/3*e),this.options.transition),i.opacity.set(0,this.options.transition),this.centerItem(this.controller.lastIndex)},module.exports=SingularSlideIn},{"./SingularLayout":57,"famous/core/Transform":13}],62:[function(require,module,exports){function SingularSoftScale(t){SingularLayout.call(this,t)}var SingularLayout=require("./SingularLayout"),Transform=require("famous/core/Transform"),Utility=require("famous/utilities/Utility");SingularSoftScale.prototype=Object.create(SingularLayout.prototype),SingularSoftScale.prototype.constructor=SingularSoftScale,SingularSoftScale.id="SingularSoftScale",SingularSoftScale.DEFAULT_OPTIONS={transition:{duration:600,curve:"easeOut"},scaleUpValue:1.3,scaleDownValue:.9,delayRatio:.05},SingularSoftScale.prototype.currentItemTransition=function(t,o,a){var i=a?this.options.scaleDownValue:this.options.scaleUpValue;t.opacity.set(0),t.childTransform.set(Transform.scale(i,i));var e=this.options.transition,r=e.duration||e.period,n=r*this.options.delayRatio;r-=n;var l=e.method?{period:r,dampingRatio:e.dampingRatio,method:e.method}:{duration:r,curve:e.curve};t.opacity.delay(n,function(){t.opacity.set(1,l),t.childTransform.set(Transform.scale(1,1),l)})},SingularSoftScale.prototype.previousItemTransition=function(t,o,a){var i=a?this.options.scaleUpValue:this.options.scaleDownValue,e=this.options.transition,r=e.method?{period:.45*e.period,method:e.method,dampingRatio:e.dampingRatio}:{duration:.45*e.duration,curve:e.curve};t.childTransform.set(Transform.scale(i,i),e),t.opacity.set(0,r)},module.exports=SingularSoftScale},{"./SingularLayout":57,"famous/core/Transform":13,"famous/utilities/Utility":42}],63:[function(require,module,exports){function SingularTwist(t){SingularLayout.call(this,t),this.options.direction=this.options.direction.toLowerCase()}function _getTransformFromDirection(t,i,r){return"x"===t?Transform.thenMove(Transform.rotateY(i),[0,0,r]):Transform.thenMove(Transform.rotateX(i),[0,0,r])}var SingularLayout=require("./SingularLayout"),Transform=require("famous/core/Transform"),Utility=require("famous/utilities/Utility"),IsIE=require("../dom/IE");SingularTwist.prototype=Object.create(SingularLayout.prototype),SingularTwist.prototype.constructor=SingularTwist,SingularTwist.id="SingularTwist",SingularTwist.DEFAULT_OPTIONS={transition:{method:"spring",dampingRatio:.85,period:600},direction:"x",flipDirection:!1,depth:-1500},SingularTwist.prototype.currentItemTransition=function(t,i,r){t.childTransform.halt(),t.opacity.set(1),IsIE&&t.item.setProperties({zIndex:1});var o;r?(o=_getTransformFromDirection(this.options.direction,.99*Math.PI,this.options.depth),t.childTransform.set(o),t.childTransform.set(Transform.identity,this.options.transition)):(o=_getTransformFromDirection(this.options.direction,.99*-Math.PI,this.options.depth),t.childTransform.set(o),t.childTransform.set(Transform.identity,this.options.transition)),this.centerItem(this.controller.index)},SingularTwist.prototype.previousItemTransition=function(t,i,r){t.childTransform.halt(),t.opacity.set(1),IsIE&&t.item.setProperties({zIndex:-1});var o;r?(t.childTransform.set(Transform.identity),o=_getTransformFromDirection(this.options.direction,.99*-Math.PI,this.options.depth),t.childTransform.set(o,this.options.transition)):(t.childTransform.set(Transform.identity),o=_getTransformFromDirection(this.options.direction,.99*Math.PI,this.options.depth),t.childTransform.set(o,this.options.transition)),this.centerItem(this.controller.lastIndex)},module.exports=SingularTwist},{"../dom/IE":48,"./SingularLayout":57,"famous/core/Transform":13,"famous/utilities/Utility":42}],64:[function(require,module,exports){function getAvailableTransitionCurves(){for(var r=getKeys(Easing).sort(),e={},n=0;n<r.length;n++)e[r[n]]=Easing[r[n]];return e}function getKeys(r){var e,n=[];for(e in r)r.hasOwnProperty(e)&&n.push(e);return n}function registerKeys(){var r=getAvailableTransitionCurves();for(var e in r)TweenTransition.registerCurve(e,r[e])}var Easing=require("famous/transitions/Easing"),TweenTransition=require("famous/transitions/TweenTransition");registerKeys()},{"famous/transitions/Easing":33,"famous/transitions/TweenTransition":39}],65:[function(require,module,exports){var Transitionable=require("famous/transitions/Transitionable"),SpringTransition=require("famous/transitions/SpringTransition"),SnapTransition=require("famous/transitions/SnapTransition"),WallTransition=require("famous/transitions/WallTransition");Transitionable.registerMethod("spring",SpringTransition),Transitionable.registerMethod("snap",SnapTransition),Transitionable.registerMethod("wall",WallTransition)},{"famous/transitions/SnapTransition":35,"famous/transitions/SpringTransition":36,"famous/transitions/Transitionable":37,"famous/transitions/WallTransition":40}],66:[function(require,module,exports){function Slide(e){Surface.call(this,{content:e,size:[!0,!0]})}var Surface=require("famous/core/Surface");Slide.prototype=Object.create(Surface.prototype),Slide.prototype.constructor=Slide,module.exports=Slide},{"famous/core/Surface":12}]},{},[44]);